PracticeProvidersPopUpCountR= \
select distinct Count(distinct vf.ServiceProviderUid) as TotalPracticeProviderCount \
from [FIGMDHQIManagement].[dbo].Viewserviceprovider vf left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc on vf.ServiceProviderUid=msc.Provideruid \
and msc.QuarterName='@QuarterOrMonth' and flag='QR' and vf.PracticeUid=msc.PracticeUid \
inner join dbo.FIGUserAuthorization fa on (case when fa.ObjectUid is not NULL then fa.ObjectUid else vf.ServiceProviderUid	 end)=vf.ServiceProviderUid	\
and type in ('1','3') and fa.ObjectName = 'provider' \
inner join FIGUser f on f.FIGUserUid=fa.FIGUserUid and f.LoginName='@loginuser' and vf.Inactive=0 \
where vf.PracticeUid IN \
 (select PracticeUid from Figuser f inner join individual i on f.Figuseruid = i.individualuid where loginname='@loginuser')
 

PracticeProviderPopUpView=select distinct (vf.Last+','+vf.First+' '+ ISNULL( vf.Middle,'') ) as "providerName",ISNULL(msc.Numerator+ msc.NotMet,0) as "All", ISNULL(msc.Numerator,0) as "Met",ISNULL(msc.NotMet,0) as NotMet, \
ISNULL(CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar),CAST(CONVERT(DECIMAL(10,2),0) AS varchar))+'%' as performance, \
'Registry Average:'+ISNULL(CAST(CONVERT(DECIMAL(10,2),NationalAverage*100 ) AS varchar),CAST(CONVERT(DECIMAL(10,2),0) AS varchar))+'%' as RegistryAverage \
from [FIGMDHQIManagement].[dbo].Viewserviceprovider vf left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc on vf.ServiceProviderUid=msc.Provideruid \
and msc.QuarterName='@QuarterOrMonth' and flag='QR' and vf.PracticeUid=msc.PracticeUid and msc.provideruid is not null and locationuid is  null \
and msc.NationalProgramQualityMeasureUid='D4494222-69FA-44F6-8055-9139D73B3CF3' and msc.LocationUid is Null \
inner join dbo.FIGUserAuthorization fa on (case when fa.ObjectUid is not NULL then fa.ObjectUid else vf.ServiceProviderUid end)=vf.ServiceProviderUid	\
and type in ('1','3') and fa.ObjectName = 'provider' inner join FIGUser f on f.FIGUserUid=fa.FIGUserUid and f.LoginName='@loginuser' and vf.Inactive=0 \
where vf.PracticeUid IN \
 (select PracticeUid from Figuser f inner join individual i on f.Figuseruid = i.individualuid where loginname='@loginuser')
 
PracticeProviderPT_Table= select QuarterName Quarter,(Numerator+NotMet) as "All",Numerator as Met, \
NotMet,(cast(cast(cast(Average as float)*100.00 as decimal(5,2))as varchar(10))+' %') as "Percentage" \
from FIGMDWeb.dbo.viewMeasurecomputationSummary \
where MeasureId='eCQM 1' and  QuarterEndDate>='2016-12-31' and QuarterEndDate<='2017-09-30' and \
PracticeUid='BE4BB6DF-A95D-4A24-ABCA-9C0481DE69F8' and ProviderUid='041AA166-19B7-4E0B-8456-4DF7B883B9F6' and LocationUid is NULL \
and Flag='QR' order by QuarterEndDate desc

PracticeProviderPatientDrillDownCountR= \
select COUNT(distinct(w.patientUid)) as MetCount \
from [10.20.201.188].[FIGMDWebPartition_2017_79].dbo.MeasureComputationProviderRollingQuarterly  pr \
inner join [10.20.201.188].[FIGMDWebPartition_2017_79].dbo.WebPatients w on w.PatientUid=pr.PatientUid \
where pr.PracticeUid='BE4BB6DF-A95D-4A24-ABCA-9C0481DE69F8' and pr.provideruid='041AA166-19B7-4E0B-8456-4DF7B883B9F6' \
and pr.MeasureUid='D4494222-69FA-44F6-8055-9139D73B3CF33' and pr.QuarterEndDate='2017-09-30' and pr.Numerator='1'     

PracticeProviderPatientDrillDownViewR= \
select distinct w.Name,w.MRN,w.Gender,w.DOB \
from [10.20.201.188].[FIGMDWebPartition_2017_79].dbo.MeasureComputationProviderRollingQuarterly  pr \
inner join [10.20.201.188].[FIGMDWebPartition_2017_79].dbo.WebPatients w on w.PatientUid=pr.PatientUid \
where pr.PracticeUid='BE4BB6DF-A95D-4A24-ABCA-9C0481DE69F8' and pr.provideruid='041AA166-19B7-4E0B-8456-4DF7B883B9F6' \
and pr.MeasureUid='D4494222-69FA-44F6-8055-9139D73B3CF33' and pr.QuarterEndDate='2017-09-30' and pr.Numerator='1'  
 

MeasureComputationPracticeRollingMonthly = \
select distinct PatientUid from MeasureComputationPracticeRollingMonthly \
where PracticeUid='@PracticeUid' and \
MeasureUid=(select distinct NationalProgramQualityMeasureUid from ViewMeasureComputationSummary where Measureid='@MeasureID') \
and Numerator=1 and MonthEndDate = (select distinct quarterEndDate from ViewMeasureComputationSummary where QuarterName ='@QuarterOrMonth')


MeasureComputationPracticeRollingQuarterly = select distinct PatientUid from MeasureComputationPracticeRollingQuarterly \
where PracticeUid='@PracticeUid' and \
MeasureUid=(select distinct NationalProgramQualityMeasureUid from ViewMeasureComputationSummary where Measureid='@MeasureID') \
and Numerator=1 and QuarterEndDate = (select distinct quarterEndDate from ViewMeasureComputationSummary where QuarterName ='@QuarterOrMonth')


ServerNameAndDatabaseQuery = \
select serverName,DatabaseName from ClinicalDataRepository CDR inner join  \
Practice P on P.ClinicalDataRepositoryUid = CDR.ClinicalDataRepositoryUid  \
where P.ExternalId = '@PracticeId'


PatientDrillDownQuery = select Name,MRN,Gender,DOB from [@servername].[@databasename].dbo.ViewPatientFromWeb where patientuid in ( @InnerQuery ) order by Name

#getDBMeasureID
MeasureIDforRegistry = select distinct measureid from viewmeasurecomputationsummary order by measureid

FavriteMeasureIDforRegistry = select distinct top 10 measureid from viewmeasurecomputationsummary MSCS \
inner join FiguserFavorite FUF on FUF.Value = MSCS.NationalProgramQualityMeasureUid \
where FUF.FIGUserUid='@FigUserUid' \
order by measureid



MeasureIDCount = select count(distinct measureid) from viewmeasurecomputationsummary



numeratorDenominatorQuery = select  Numerator,Denominator from ViewMeasureComputationSummary where \
NationalProgramQualityMeasureUid='@measureuid' \
and QuarterName ='@QuarterOrMonth'  \
and practiceuid ='@practiceuid' \
and provideruid is null \
and locationuid is null


LatestQuaterOrMonthQuery = select distinct QuarterName from ViewMeasureComputationSummary where QuarterEndDate in \
(select max(cast(QuarterEndDate as date)) from ViewMeasureComputationSummary where practiceuid='@practiceuid' )order by QuarterName


PopupLocationGridQuery = select SL.Name locationname,(MCS.Average*100) performance,MCS.Denominator qualified,MCS.Numerator met,MCS.NotMet notmet \
from ViewServiceLocation SL \
left join ViewMeasureComputationSummary MCS on (SL.ServiceLocationUid=MCS.LocationUid and MCS.QuarterName='@QuarterOrMonth' and MCS.NationalProgramQualityMeasureUid = (select distinct NationalProgramQualityMeasureUid from ViewMeasureComputationSummary where Measureid='@MeasureID') and MCS.provideruid is null and MCS.LocationUid is not null) \
where  SL.PracticeUid='@practiceuid' and SL.Inactive=0 order by SL.Name


PopupProviderGridQuery = select SP.ListName Providername,(MCS.Average*100) performance,MCS.Denominator qualified,MCS.Numerator met,MCS.NotMet notmet \
from viewServiceProvider SP left join ViewMeasureComputationSummary MCS on (SP.ServiceProviderUid=MCS.ProviderUid and MCS.QuarterName='@QuarterOrMonth' and MCS.NationalProgramQualityMeasureUid = (select distinct NationalProgramQualityMeasureUid from ViewMeasureComputationSummary where Measureid='@measureuid') \
and MCS.provideruid is not null and MCS.LocationUid is  null) \
where SP.PracticeUid='@practiceuid' and SP.Inactive=0  and SP.Type in (1,3) order by SP.ListName


ProviderPerformanceTrendQuery = select QuarterName,Denominator,Numerator,NotMet,(Average*100) 'Average' from ViewMeasureComputationSummary CS where PracticeUid= '@practiceuid' \
and ProviderUid ='@ProviderUid' and LocationUid is null and Flag=(select distinct flag from ViewMeasureComputationSummary where QuarterName ='@QuarterOrMonth') and Measureid= @measureid \
and quarterEndDate <= (select distinct quarterEndDate from ViewMeasureComputationSummary where QuarterName ='@QuarterOrMonth') \
order by cast(quarterEndDate as date) desc 

LocationPerformanceTrendQuery = select QuarterName,Denominator,Numerator,NotMet,(Average*100) 'Average' from ViewMeasureComputationSummary CS where PracticeUid= '@practiceuid' \
and ProviderUid is null and LocationUid='@LocationUid' and Flag=(select distinct flag from ViewMeasureComputationSummary where QuarterName ='@QuarterOrMonth') and Measureid= @measureid \
and quarterEndDate <= (select distinct quarterEndDate from ViewMeasureComputationSummary where QuarterName ='@QuarterOrMonth') \
order by cast(quarterEndDate as date) desc 



# Administration<<<<Location
Locationgridcount= SELECT COUNT(InstitutionUid) FROM dbo.Institution WHERE PracticeUid IN(SELECT PracticeUid FROM dbo.Individual WHERE IndividualUid IN(SELECT FIGUserUid FROM dbo.FigUser WHERE LoginName ='@loginuser'))



LocationEnlisted =SELECT top 15  ISNULL(ins.Name,'') as locationname , ISNULL(mc.Name,'') as City ,ISNULL(mp.Name,'') as State,ISNULL(mpc.Code,'') as Postalcode, \
  CASE ins.INACTIVE \
WHEN '0' THEN 'No' \
WHEN '1' THEN 'Yes' \
END Inactive \
FROM dbo.Individual i \
INNER JOIN dbo.FIGUser fu ON i.IndividualUid =fu.FIGUserUid \
INNER JOIN dbo.Practice p ON i.PracticeUid = p.PracticeUid \
INNER JOIN dbo.Institution ins ON ins.PracticeUid =p.PracticeUid \
INNER JOIN dbo.ServiceLocation sl ON ins.InstitutionUid = sl.ServiceLocationUid \
left JOIN dbo.Address ad ON ad.AddressUid=ins.Address1Uid \
left JOIN dbo.MasterCity mc ON mc.CityUid=ad.CityUid \
left JOIN dbo.MasterCountry msc ON msc.CountryUid=ad.CountryUid \
left JOIN dbo.MasterPostalCode mpc ON mpc.PostalCodeUid=ad.PostalCodeUid \
LEFT JOIN dbo.MasterState mp ON mp.StateUid=ad.StateUid \
WHERE  fu.LoginName='@loginuser' \
ORDER BY ins.Name 


searchfunctinality =SELECT top 15  ISNULL(ins.Name,'') as locationname , ISNULL(mc.Name,'') as City ,ISNULL(mp.Name,'') as State,ISNULL(mpc.Code,'') as Postalcode, \
  CASE ins.INACTIVE \
WHEN '0' THEN 'No' \
WHEN '1' THEN 'Yes' \
END Inactive \
FROM dbo.Individual i \
INNER JOIN dbo.FIGUser fu ON i.IndividualUid =fu.FIGUserUid \
INNER JOIN dbo.Practice p ON i.PracticeUid = p.PracticeUid \
INNER JOIN dbo.Institution ins ON ins.PracticeUid =p.PracticeUid \
INNER JOIN dbo.ServiceLocation sl ON ins.InstitutionUid = sl.ServiceLocationUid \
left JOIN dbo.Address ad ON ad.AddressUid=ins.Address1Uid \
left JOIN dbo.MasterCity mc ON mc.CityUid=ad.CityUid \
left JOIN dbo.MasterCountry msc ON msc.CountryUid=ad.CountryUid \
left JOIN dbo.MasterPostalCode mpc ON mpc.PostalCodeUid=ad.PostalCodeUid \
LEFT JOIN dbo.MasterState mp ON mp.StateUid=ad.StateUid \
WHERE fu.LoginName='@loginuser' \
 and ins.Name like '@data%' \
ORDER BY ins.Name 



Sortinglocation =SELECT top 15  ISNULL(ins.Name,'') as locationname , ISNULL(mc.Name,'') as City ,ISNULL(mp.Name,'') as State,ISNULL(mpc.Code,'') as Postalcode, \
  CASE ins.INACTIVE \
WHEN '0' THEN 'No' \
WHEN '1' THEN 'Yes' \
END Inactive \
FROM dbo.Individual i \
INNER JOIN dbo.FIGUser fu ON i.IndividualUid =fu.FIGUserUid \
INNER JOIN dbo.Practice p ON i.PracticeUid = p.PracticeUid \
INNER JOIN dbo.Institution ins ON ins.PracticeUid =p.PracticeUid \
INNER JOIN dbo.ServiceLocation sl ON ins.InstitutionUid = sl.ServiceLocationUid \
left JOIN dbo.Address ad ON ad.AddressUid=ins.Address1Uid \
left JOIN dbo.MasterCity mc ON mc.CityUid=ad.CityUid \
left JOIN dbo.MasterCountry msc ON msc.CountryUid=ad.CountryUid \
left JOIN dbo.MasterPostalCode mpc ON mpc.PostalCodeUid=ad.PostalCodeUid \
LEFT JOIN dbo.MasterState mp ON mp.StateUid=ad.StateUid \
WHERE fu.LoginName='@loginuser' \
ORDER BY ins.Name desc 


Sortinglocation =SELECT top 15  ISNULL(ins.Name,'') as locationname , ISNULL(mc.Name,'') as City ,ISNULL(mp.Name,'') as State,ISNULL(mpc.Code,'') as Postalcode, \
  CASE ins.INACTIVE \
WHEN '0' THEN 'No' \
WHEN '1' THEN 'Yes' \
END Inactive \
FROM dbo.Individual i \
INNER JOIN dbo.FIGUser fu ON i.IndividualUid =fu.FIGUserUid \
INNER JOIN dbo.Practice p ON i.PracticeUid = p.PracticeUid \
INNER JOIN dbo.Institution ins ON ins.PracticeUid =p.PracticeUid \
INNER JOIN dbo.ServiceLocation sl ON ins.InstitutionUid = sl.ServiceLocationUid \
left JOIN dbo.Address ad ON ad.AddressUid=ins.Address1Uid \
left JOIN dbo.MasterCity mc ON mc.CityUid=ad.CityUid \
left JOIN dbo.MasterCountry msc ON msc.CountryUid=ad.CountryUid \
left JOIN dbo.MasterPostalCode mpc ON mpc.PostalCodeUid=ad.PostalCodeUid \
LEFT JOIN dbo.MasterState mp ON mp.StateUid=ad.StateUid \
WHERE fu.LoginName='@loginuser' \
ORDER BY ins.Name desc 



Usermangementlistofuser=SELECT TOP 15 i.First as firstname,ISNULL(i.Middle,'') as middlename,i.Last as lastname,pr.ExternalID as practiceid,pr.ListName as practicename,fg.LoginName as loginame , \
 CASE fg.Inactive \
WHEN '0' THEN 'No' \
WHEN '1' THEN 'Yes' \
END  as inactive FROM dbo.Individual i \
INNER JOIN dbo.Practice pr ON i.PracticeUid=pr.PracticeUid \
INNER JOIN dbo.FIGUser fg ON fg.FIGUserUid=i.IndividualUid \
WHERE  pr.ListName='Web Demo Practice' \
 ORDER BY fg.LoginName
 
 
 
 UsermangementSearch=SELECT * FROM ( \
 SELECT  i.First as firstname,ISNULL(i.Middle,'') as middlename,i.Last as lastname,pr.ExternalID as practiceid,pr.ListName as practicename,fg.LoginName as loginame , \
 CASE fg.Inactive \
WHEN '0' THEN 'No' \
WHEN '1' THEN 'Yes' \
END  as inactive, \
ROW_NUMBER() OVER(ORDER BY fg.LoginName) AS Rownumber \
 FROM dbo.Individual i \
INNER JOIN dbo.Practice pr ON i.PracticeUid=pr.PracticeUid \
INNER JOIN dbo.FIGUser fg ON fg.FIGUserUid=i.IndividualUid \
WHERE  fg.LoginName='@loginuser' \
and i.First like '@data%')  AS location \
 WHERE  Rownumber BETWEEN 1 AND 15 



 
 UsermangementSort=  SELECT i.First as firstname,ISNULL(i.Middle,'') as middlename,i.Last as lastname,pr.ExternalID as practiceid,pr.ListName as practicename,fg.LoginName as loginame , \
 CASE fg.Inactive \
WHEN '0' THEN 'No' \
WHEN '1' THEN 'Yes' \
END  as inactive FROM dbo.Individual i \
INNER JOIN dbo.Practice pr ON i.PracticeUid=pr.PracticeUid \
INNER JOIN dbo.FIGUser fg ON fg.FIGUserUid=i.IndividualUid \
WHERE  pr.ListName='Web Demo Practice' \
ORDER BY fg.LoginName desc


Locationpagination=DECLARE @RowspPage AS INT \
SET @RowspPage = 15 \
Select  * from ( \
SELECT  ISNULL(ins.Name,'') as locationname , ISNULL(mc.Name,'') as City ,ISNULL(mp.Name,'') as State,ISNULL(mpc.Code,'') as Postalcode, \
CASE WHEN vf.Inactive='0' THEN 'No' Else 'Yes' \
END Inactive, \
ROW_NUMBER() OVER(ORDER BY ins.Name) AS Rownumber \
FROM dbo.Individual i \
INNER JOIN dbo.FIGUser fu ON i.IndividualUid =fu.FIGUserUid \
INNER JOIN dbo.Practice p ON i.PracticeUid = p.PracticeUid \
INNER JOIN dbo.Institution ins ON ins.PracticeUid =p.PracticeUid \
INNER Join dbo.ViewFacility vf On vf.ServiceLocationUid=ins.InstitutionUid \
INNER JOIN dbo.ServiceLocation sl ON ins.InstitutionUid = sl.ServiceLocationUid \
left JOIN dbo.Address ad ON ad.AddressUid=ins.Address1Uid \
left JOIN dbo.MasterCity mc ON mc.CityUid=ad.CityUid \
left JOIN dbo.MasterCountry msc ON msc.CountryUid=ad.CountryUid \
left JOIN dbo.MasterPostalCode mpc ON mpc.PostalCodeUid=ad.PostalCodeUid \
LEFT JOIN dbo.MasterState mp ON mp.StateUid=ad.StateUid \
WHERE fu.LoginName='@loginuser' ) as location \
WHERE Rownumber BETWEEN ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage) order by locationname






UsermangementPagination= DECLARE  @RowspPage AS INT \
SET @RowspPage = 15 \
SELECT * FROM ( \
SELECT  i.First as firstname,ISNULL(i.Middle,'') as middlename,i.Last as lastname,pr.ExternalID as practiceid,pr.ListName as practicename,fg.LoginName as loginame , \
CASE fg.Inactive \
WHEN '0' THEN 'No' \
WHEN '1' THEN 'Yes' \
END  as inactive, \
ROW_NUMBER() OVER(ORDER BY fg.LoginName) AS Rownumber \
 FROM dbo.Individual i \
INNER JOIN dbo.Practice pr ON i.PracticeUid=pr.PracticeUid  \
INNER JOIN dbo.FIGUser fg ON fg.FIGUserUid=i.IndividualUid  \
WHERE  pr.ListName='Web Demo Practice' \
               ) AS TBL \
WHERE Rownumber BETWEEN ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage)

ValidateTotalPracticeCount = SELECT TOP 15 ExternalID,ListName,ISNULL(NPI,'') AS npi, \
CASE inactive \
WHEN '0'THEN 'No' \
WHEN '1'THEN 'Yes' END inactive \
FROM dbo.Practice where ListName = 'Web Demo Practice' ORDER BY ListName

PracticePegination=DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = @currentPage SET @RowspPage = 15 \
SELECT * FROM \
(SELECT  ExternalID,ListName,ISNULL(NPI,'') AS npi, \
CASE inactive WHEN '0'THEN 'No' WHEN '1'THEN 'Yes' END inactive, \
ROW_NUMBER() OVER(ORDER BY ListName) as Rownumber \
FROM dbo.Practice) tbl WHERE  Rownumber BETWEEN ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage);

UserGroupPagination=DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = @currentPage SET @RowspPage = 15 \
SELECT * FROM (SELECT ExternalID,Name ,ROW_NUMBER() OVER(ORDER BY ExternalID) as Rownumber \
FROM FIGUserGroup WHERE \
CreatedByUid='C1C7D30A-ACAF-473A-9DF1-891D78838C6D') tble  WHERE Rownumber  \
BETWEEN ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage);

#Dashboard practice
MeasureComputationPracticeRollingMonthly = \
select distinct PatientUid from MeasureComputationPracticeRollingMonthly \
where PracticeUid='@PracticeUid' and \
MeasureUid=(select distinct NationalProgramQualityMeasureUid from ViewMeasureComputationSummary where Measureid='@MeasureID') \
and Numerator=1 and MonthEndDate = (select distinct quarterEndDate from ViewMeasureComputationSummary where QuarterName ='@QuarterOrMonth')


MeasureComputationPracticeRollingQuarterly = select distinct PatientUid from MeasureComputationPracticeRollingQuarterly \
where PracticeUid='@PracticeUid' and \
MeasureUid=(select distinct NationalProgramQualityMeasureUid from ViewMeasureComputationSummary where Measureid='@MeasureID') \
and Numerator=1 and QuarterEndDate = (select distinct quarterEndDate from ViewMeasureComputationSummary where QuarterName ='@QuarterOrMonth')


ServerNameAndDatabaseQuery = \
select serverName,DatabaseName from ClinicalDataRepository CDR inner join  \
Practice P on P.ClinicalDataRepositoryUid = CDR.ClinicalDataRepositoryUid  \
where P.ExternalId = '@PracticeId'


PatientDrillDownQuery = select Name,MRN,Gender,DOB from [@servername].[@databasename].dbo.ViewPatientFromWeb where patientuid in ( @InnerQuery ) order by Name

#getDBMeasureID
MeasureIDforRegistry = select distinct measureid from viewmeasurecomputationsummary order by measureid

FavriteMeasureIDforRegistry = select distinct top 10 measureid from viewmeasurecomputationsummary MSCS \
inner join FiguserFavorite FUF on FUF.Value = MSCS.NationalProgramQualityMeasureUid \
where FUF.FIGUserUid='@FigUserUid' \
order by measureid



MeasureIDCount = select count(distinct measureid) from viewmeasurecomputationsummary

numeratorDenominatorQuery = select  Numerator,Denominator from ViewMeasureComputationSummary where \
NationalProgramQualityMeasureUid='@measureuid' \
and QuarterName ='@QuarterOrMonth'  \
and practiceuid ='@practiceuid' \
and provideruid is null \
and locationuid is null 


LatestQuaterOrMonthQuery = select distinct QuarterName from ViewMeasureComputationSummary where QuarterEndDate in \
(select max(cast(QuarterEndDate as date)) from ViewMeasureComputationSummary where practiceuid='@practiceuid' )order by QuarterName


PopupLocationGridQuery = select SL.Name locationname,(MCS.Average*100) performance,MCS.Denominator qualified,MCS.Numerator met,MCS.NotMet notmet \
from ViewServiceLocation SL \
left join ViewMeasureComputationSummary MCS on (SL.ServiceLocationUid=MCS.LocationUid and MCS.QuarterName='@QuarterOrMonth' and MCS.NationalProgramQualityMeasureUid = (select distinct NationalProgramQualityMeasureUid from ViewMeasureComputationSummary where Measureid='@MeasureID') and MCS.provideruid is null and MCS.LocationUid is not null) \
where  SL.PracticeUid='@practiceuid' and SL.Inactive=0 order by SL.Name


PopupProviderGridQuery = select SP.ListName Providername,(MCS.Average*100) performance,MCS.Denominator qualified,MCS.Numerator met,MCS.NotMet notmet \
from viewServiceProvider SP left join ViewMeasureComputationSummary MCS on (SP.ServiceProviderUid=MCS.ProviderUid and MCS.QuarterName='@QuarterOrMonth' and MCS.NationalProgramQualityMeasureUid = (select distinct NationalProgramQualityMeasureUid from ViewMeasureComputationSummary where Measureid='@measureuid') \
and MCS.provideruid is not null and MCS.LocationUid is  null) \
where SP.PracticeUid='@practiceuid' and SP.Inactive=0  and SP.Type in (1,3) order by SP.ListName


ProviderPerformanceTrendQuery = select QuarterName,Denominator,Numerator,NotMet,(Average*100) 'Average' from ViewMeasureComputationSummary CS where PracticeUid= '@practiceuid' \
and ProviderUid ='@ProviderUid' and LocaValidateTotalPracticeLabeltionUid is null and Flag=(select distinct flag from ViewMeasureComputationSummary where QuarterName ='@QuarterOrMonth') and Measureid= @measureid \
and quarterEndDate <= (select distinct quarterEndDate from ViewMeasureComputationSummary where QuarterName ='@QuarterOrMonth') \
order by cast(quarterEndDate as date) desc 

LocationPerformanceTrendQuery = select QuarterName,Denominator,Numerator,NotMet,(Average*100) 'Average' from ViewMeasureComputationSummary CS where PracticeUid= '@practiceuid' \
and ProviderUid is null and LocationUid='@LocationUid' and Flag=(select distinct flag from ViewMeasureComputationSummary where QuarterName ='@QuarterOrMonth') and Measureid= @measureid \
and quarterEndDate <= (select distinct quarterEndDate from ViewMeasureComputationSummary where QuarterName ='@QuarterOrMonth') \
order by cast(quarterEndDate as date) desc 

ValidateTotalPracticeLabel = SELECT COUNT(ExternalID) FROM dbo.Practice where  ListName like 'Web Demo Practice'
ValidateTotalPracticeCount = SELECT TOP 1 ExternalID,ListName,ISNULL(NPI,'') AS npi, \
CASE inactive \
WHEN '0'THEN 'No' \
WHEN '1'THEN 'Yes' END inactive \
FROM dbo.Practice where ListName like 'Web Demo Practice' ORDER BY ListName

#AdminiStaration >> practice
GetFiguserUID=SELECT  FIGUserUid FROM figuser WHERE LoginName='@username'

ValidateSortingThroughExternallID=SELECT * FROM (SELECT ExternalID,ListName,ISNULL(NPI,'') AS npi, \
 CASE inactive WHEN '0'THEN 'No' WHEN '1'THEN 'Yes' END inactive , \
 ROW_NUMBER() OVER (ORDER BY ExternalID) AS orderongNumber FROM \
 dbo.Practice where ListName like 'Web Demo Practice')Practice  WHERE orderongNumber  BETWEEN 1 and  1
 
ValidateSearchingThroughExternallID=SELECT * FROM (SELECT ExternalID,ListName,ISNULL(NPI,'') AS npi, \
    CASE inactive WHEN '0'THEN 'No' WHEN '1'THEN 'Yes' END inactive ,ROW_NUMBER() OVER \
    (ORDER BY ListName) AS orderongNumber FROM dbo.Practice WHERE ExternalID LIKE '@searchvalue%') Practice WHERE  orderongNumber BETWEEN 1 and  15;

#Administration >> GroupManagement    
ValidateGroupManagementTable=SELECT TOP 15 ExternalID,Name FROM FIGUserGroup WHERE CreatedByUid='C1C7D30A-ACAF-473A-9DF1-891D78838C6D' ORDER BY ExternalID 
ValidateSearchingThroughID=SELECT top 15 ExternalID,Name FROM FIGUserGroup WHERE CreatedByUid='C1C7D30A-ACAF-473A-9DF1-891D78838C6D' AND ExternalID LIKE '@searchvalue%' ORDER BY Name
ValidateGroupSortingThroughExternallID=SELECT TOP 15 ExternalID,Name FROM FIGUserGroup WHERE CreatedByUid='C1C7D30A-ACAF-473A-9DF1-891D78838C6D' ORDER BY ExternalID

#Administration >> GroupManagement  >> Associated User
ValidateTableOfAssociatedUser=SELECT top 5 fu.LoginName,i.First,last,isnull(p.ExternalID,'')[Practice ID],ISNULL(p.ListName,'')[Practice Name], \
CASE  fu.Inactive WHEN '0'THEN 'No' WHEN '1'THEN 'Yes' END AS inactive \
FROM  figusergroup fg INNER JOIN dbo.FIGUserGroupMember GM ON fg.FIGUserGroupUid = gm.GroupUid \
INNER JOIN dbo.FIGUser fu ON fu.FIGUserUid = GM.FIGUserUid \
INNER JOIN dbo.Individual i ON i.IndividualUid = fu.FIGUserUid \
left JOIN dbo.Practice p ON p.PracticeUid = i.PracticeUid \
WHERE fg.ExternalID='001_At_Test' ORDER BY fu.LoginName 

ValidateSearchingThroughLoginName=SELECT fu.LoginName,i.First,last,isnull(p.ExternalID,'')[Practice ID],ISNULL(p.ListName,'')[Practice Name], \
CASE  fu.Inactive WHEN '0'THEN 'No' WHEN '1'THEN 'Yes' END AS inactive \
FROM  figusergroup fg INNER JOIN dbo.FIGUserGroupMember GM ON fg.FIGUserGroupUid = gm.GroupUid \
INNER JOIN dbo.FIGUser fu ON fu.FIGUserUid = GM.FIGUserUid \
INNER JOIN dbo.Individual i ON i.IndividualUid = fu.FIGUserUid \
left JOIN dbo.Practice p ON p.PracticeUid = i.PracticeUid \
WHERE fg.ExternalID='001_At_Test' AND fu.LoginName LIKE '@searchvalue%' \
ORDER BY fu.LoginName

ValidateSortingOfAssociatedUser=SELECT top 5 fu.LoginName,i.First,last,isnull(p.ExternalID,'')[Practice ID],ISNULL(p.ListName,'')[Practice Name], \
CASE  fu.Inactive WHEN '0'THEN 'No' WHEN '1'THEN 'Yes' END AS inactive \
FROM  figusergroup fg INNER JOIN dbo.FIGUserGroupMember GM ON fg.FIGUserGroupUid = gm.GroupUid \
INNER JOIN dbo.FIGUser fu ON fu.FIGUserUid = GM.FIGUserUid \
INNER JOIN dbo.Individual i ON i.IndividualUid = fu.FIGUserUid \
left JOIN dbo.Practice p ON p.PracticeUid = i.PracticeUid \
WHERE fg.ExternalID='001_At_Test' ORDER BY LoginName DESC 

ValidateTableOfAuthorizedUsersGroups=select top 5 fu.LoginName,i.First,last,isnull(p.ExternalID,'')[Practice ID],ISNULL(p.ListName,'')[Practice Name], \
CASE fa.objectname when 'UserGroup' THEN 'No' end as isgroup, \
CASE  fu.Inactive WHEN '0'THEN 'No' WHEN '1'THEN 'Yes' END AS inactive \
from FIGUserAuthorization fa inner join figusergroup fg on fa.objectuid=fg.FIGUserGroupUid  \
INNER JOIN dbo.FIGUser fu ON fu.FIGUserUid = fa.FIGUserUid \
INNER JOIN dbo.Individual i ON i.IndividualUid = fu.FIGUserUid \
left JOIN dbo.Practice p ON p.PracticeUid = i.PracticeUid \
where  fg.ExternalID='@replacekey' order by fu.LoginName

ValidateSearchingOfAuthorizedUsersGroups=select top 5 fu.LoginName,i.First,last,isnull(p.ExternalID,'')[Practice ID],ISNULL(p.ListName,'')[Practice Name], \
case fa.objectname when 'UserGroup' THEN 'No' end as isgroup, \
CASE  fu.Inactive WHEN '0'THEN 'No' WHEN '1'THEN 'Yes' END AS inactive \
from FIGUserAuthorization fa inner join figusergroup fg on fa.objectuid=fg.FIGUserGroupUid \
INNER JOIN dbo.FIGUser fu ON fu.FIGUserUid = fa.FIGUserUid \
INNER JOIN dbo.Individual i ON i.IndividualUid = fu.FIGUserUid \
left JOIN dbo.Practice p ON p.PracticeUid = i.PracticeUid \
where  fg.ExternalID='001_At_Test' and fu.LoginName LIKE '@searchvalue%' order by fu.LoginName

ValidateSortingOfAuthorizedUsersGroups=	select top 5 fu.LoginName,i.First,last,isnull(p.ExternalID,'')[Practice ID],ISNULL(p.ListName,'')[Practice Name], \
case fa.objectname when 'UserGroup' THEN 'No' end as isgroup, \
CASE  fu.Inactive WHEN '0'THEN 'No' WHEN '1'THEN 'Yes' END AS inactive \
from FIGUserAuthorization fa inner join figusergroup fg on fa.objectuid=fg.FIGUserGroupUid \
INNER JOIN dbo.FIGUser fu ON fu.FIGUserUid = fa.FIGUserUid \
INNER JOIN dbo.Individual i ON i.IndividualUid = fu.FIGUserUid \
left JOIN dbo.Practice p ON p.PracticeUid = i.PracticeUid \
where  fg.ExternalID='001_At_Test' order by fu.LoginName desc

PracticePegination=DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = @currentPage SET @RowspPage = 15 \
SELECT * FROM \
(SELECT  ExternalID,ListName,ISNULL(NPI,'') AS npi, \
CASE inactive WHEN '0'THEN 'No' WHEN '1'THEN 'Yes' END inactive, \
ROW_NUMBER() OVER(ORDER BY ListName) as Rownumber \
FROM dbo.Practice) tbl WHERE  Rownumber BETWEEN ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage);

UserGroupPagination=DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = @currentPage SET @RowspPage = 15 \
SELECT * FROM (SELECT ExternalID,Name ,ROW_NUMBER() OVER(ORDER BY ExternalID) as Rownumber \
FROM FIGUserGroup WHERE \
CreatedByUid='C1C7D30A-ACAF-473A-9DF1-891D78838C6D') tble  WHERE Rownumber  \
BETWEEN ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage);

AssociatedUsersPagination=DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = @currentPage SET @RowspPage = 5 \
select * from ( \
SELECT fu.LoginName,i.First,last,isnull(p.ExternalID,'')[Practice ID],ISNULL(p.ListName,'')[Practice Name], \
CASE  fu.Inactive WHEN '0'THEN 'No' WHEN '1'THEN 'Yes' END AS inactive, \
ROW_NUMBER() OVER(ORDER BY fu.LoginName) as Rownumber \
FROM  figusergroup fg INNER JOIN dbo.FIGUserGroupMember GM ON fg.FIGUserGroupUid = gm.GroupUid \
INNER JOIN dbo.FIGUser fu ON fu.FIGUserUid = GM.FIGUserUid \
INNER JOIN dbo.Individual i ON i.IndividualUid = fu.FIGUserUid \
left JOIN dbo.Practice p ON p.PracticeUid = i.PracticeUid \
WHERE fg.ExternalID='001_At_Test' )tble where Rownumber between ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage);

AuthorizedUsersGroupsPagination=DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = @currentPage SET @RowspPage = 5 \
select * from( \
select fu.LoginName,i.First,last,isnull(p.ExternalID,'')[Practice ID],ISNULL(p.ListName,'')[Practice Name], \
CASE fa.objectname when 'UserGroup' THEN 'No' end as isgroup, \
CASE  fu.Inactive WHEN '0'THEN 'No' WHEN '1'THEN 'Yes' END AS inactive, \
ROW_NUMBER() OVER(order by fu.LoginName) as Rownumber \
from FIGUserAuthorization fa inner join figusergroup fg on fa.objectuid=fg.FIGUserGroupUid  \
INNER JOIN dbo.FIGUser fu ON fu.FIGUserUid = fa.FIGUserUid \
INNER JOIN dbo.Individual i ON i.IndividualUid = fu.FIGUserUid \
left JOIN dbo.Practice p ON p.PracticeUid = i.PracticeUid \
where  fg.ExternalID='001_At_Test' ) tble where  Rownumber between ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage);

getLoggedInUserFIGUserUID=select figuseruid from figuser where loginname ='@userName';

# Administration<<<<Provider
ProviderCountAdmin= SELECT COUNT(distinct I.IndividualUid) as cnt FROM dbo.FIGUserAuthorization fa \
INNER JOIN dbo.Individual i ON i.IndividualUid = FA.ObjectUid \
INNER JOIN dbo.ServiceProvider SP ON SP.ServiceProviderUid = I.IndividualUid \
WHERE OBJECtname = 'provider' \
AND figuseruid IN (SELECT figuseruid FROM figuser WHERE loginname LIKE '@loginuser')


ProviderTable= SELECT DISTINCT top 15 I.First firstname, \
ISNULL(I.Middle,'') middlename \
,I.Last lastname,I.EmailAddress emailaddress,SP.NPI npi, \
CASE SP.INACTIVE \
WHEN '0' THEN 'No' \
WHEN '1' THEN 'Yes' \
END inactive \
FROM dbo.FIGUserAuthorization fa \
INNER JOIN dbo.Individual i ON i.IndividualUid = FA.ObjectUid \
INNER JOIN dbo.ServiceProvider SP ON SP.ServiceProviderUid = I.IndividualUid \
WHERE OBJECtname = 'provider' AND figuseruid \
IN(SELECT figuseruid FROM figuser WHERE loginname LIKE '@loginuser') \
ORDER BY SP.NPI

ProviderTableSort= SELECT DISTINCT top 15 I.First firstname, \
ISNULL(I.Middle,'') middlename \
,I.Last lastname,I.EmailAddress emailaddress,SP.NPI npi, \
CASE SP.INACTIVE \
WHEN '0' THEN 'No' \
WHEN '1' THEN 'Yes' \
END inactive \
FROM dbo.FIGUserAuthorization fa \
INNER JOIN dbo.Individual i ON i.IndividualUid = FA.ObjectUid \
INNER JOIN dbo.ServiceProvider SP ON SP.ServiceProviderUid = I.IndividualUid \
WHERE OBJECtname = 'provider' AND figuseruid \
IN(SELECT figuseruid FROM figuser WHERE loginname LIKE '@loginuser') \
ORDER BY SP.NPI desc



SearchProviderByNPI= SELECT DISTINCT  I.First firstname, \
ISNULL(I.Middle,'') middlename \
,I.Last lastname,I.EmailAddress emailaddress,SP.NPI npi, \
CASE SP.INACTIVE \
WHEN '0' THEN 'No' \
WHEN '1' THEN 'Yes' \
END inactive \
FROM dbo.FIGUserAuthorization fa \
INNER JOIN dbo.Individual i ON i.IndividualUid = FA.ObjectUid \
INNER JOIN dbo.ServiceProvider SP ON SP.ServiceProviderUid = I.IndividualUid \
WHERE OBJECtname = 'provider' AND figuseruid \
IN(SELECT figuseruid FROM figuser WHERE loginname = '@loginuser') \
AND SP.NPI= '@searchnpi' \
ORDER BY SP.NPI;

SortProviderByFirst= SELECT DISTINCT top 15 I.First firstname, \
ISNULL(I.Middle,'') middlename \
,I.Last lastname,I.EmailAddress emailaddress,SP.NPI npi, \
CASE SP.INACTIVE \
WHEN '0' THEN 'No' \
WHEN '1' THEN 'Yes' \
END inactive \
FROM dbo.FIGUserAuthorization fa \
INNER JOIN dbo.Individual i ON i.IndividualUid = FA.ObjectUid \
INNER JOIN dbo.ServiceProvider SP ON SP.ServiceProviderUid = I.IndividualUid \
WHERE OBJECtname = 'provider' AND figuseruid \
IN(SELECT figuseruid FROM figuser WHERE loginname = '@loginuser') \
ORDER BY I.First;

SortProviderByLast= SELECT DISTINCT top 15 I.First firstname, \
ISNULL(I.Middle,'') middlename \
,I.Last lastname,I.EmailAddress emailaddress,SP.NPI npi, \
CASE SP.INACTIVE \
WHEN '0' THEN 'No' \
WHEN '1' THEN 'Yes' \
END inactive \
FROM dbo.FIGUserAuthorization fa \
INNER JOIN dbo.Individual i ON i.IndividualUid = FA.ObjectUid \
INNER JOIN dbo.ServiceProvider SP ON SP.ServiceProviderUid = I.IndividualUid \
WHERE OBJECtname = 'provider' AND figuseruid \
IN(SELECT figuseruid FROM figuser WHERE loginname = '@loginuser') \
ORDER BY I.Last;

ProviderPagination=WITH OrderedRecords AS \
(SELECT DISTINCT ROW_NUMBER()OVER (ORDER BY npi,first,last) AS Rownumber,count(0) cnt, \
I.First firstname, \
ISNULL(I.Middle,'') middlename \
,I.Last lastname,I.EmailAddress emailaddress,SP.NPI npi, \
CASE SP.INACTIVE \
WHEN '0' THEN 'No' \
WHEN '1' THEN 'Yes' \
END inactive \
FROM dbo.FIGUserAuthorization fa \
INNER JOIN dbo.Individual i ON i.IndividualUid = FA.ObjectUid \
INNER JOIN dbo.ServiceProvider SP ON SP.ServiceProviderUid = I.IndividualUid \
WHERE OBJECtname = 'provider' AND figuseruid \
IN(SELECT figuseruid FROM figuser WHERE loginname LIKE '@loginuser') \
group by SP.INACTIVE ,I.First , i.middle \
,I.Last,I.EmailAddress,SP.NPI) \
  SELECT * FROM OrderedRecords WHERE RowNumber BETWEEN (((@pagenumber-1)*15)+ 1) AND @pagenumber*15;



#GPRO Submission

GroupPracticeMeasure=SELECT a.pqrsno as pqrsno, \
a.measurename as measuretitle, \
b.Name as qualitydomain, \
case a.iscrosscuttingmeasure when 0 then 'No' \
ELSE 'Yes' \
END as crosscutting \
from [FIGMDPQRSSubmissionDemo].dbo.PQRSGPROQualityMeasure as a \
LEFT join PQRSGPROQualityMeasureDomain as b on a.PQRSGPROQualityMeasureDomainUid=b.PQRSGPROQualityMeasureDomainUid \
where a.type=1 \
order by CAST(a.pqrsno as integer);


GPROReportedPatientVisitGrid=select top 10 p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT ', P-' + aa.PQRSNo \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')) \
and pvv.serviceprovideruid is null and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].pqrsgprosubmission where PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pv.serviceprovideruid is null \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid order by pv.visitdate desc,p.first,p.last;


GPRORPVSearchByFirst= select top 10 p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT ', P-' + aa.PQRSNo \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')) \
and pvv.serviceprovideruid is null and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].pqrsgprosubmission where PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pv.serviceprovideruid is null \
and p.first like '%@searchkey%' \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid order by pv.visitdate desc,p.first,p.last;

GPRORPVSearchByLast= select top 10 p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT ', P-' + aa.PQRSNo \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')) \
and pvv.serviceprovideruid is null and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].pqrsgprosubmission where PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pv.serviceprovideruid is null \
and p.last like '%@searchkey%' \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid order by pv.visitdate desc,p.first,p.last;

GPRORPVSearchByGender= select top 10 p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT ', P-' + aa.PQRSNo \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')) \
and pvv.serviceprovideruid is null and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].pqrsgprosubmission where PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pv.serviceprovideruid is null \
and p.gender like '%@searchkey%' \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid order by pv.visitdate desc,p.first,p.last;

GPRORPVSearchByDateOfBirth= select top 10 p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT ', P-' + aa.PQRSNo \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')) \
and pvv.serviceprovideruid is null and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].pqrsgprosubmission where PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pv.serviceprovideruid is null \
and CONVERT(VARCHAR(24),p.birthdate,110) = '@searchkey' \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid order by pv.visitdate desc,p.first,p.last;

GPRORPVSearchByMrn= select top 10 p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT ', P-' + aa.PQRSNo \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')) \
and pvv.serviceprovideruid is null and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].pqrsgprosubmission where PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pv.serviceprovideruid is null \
and p.medicalrecordnumber like '%@searchkey%' \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid order by pv.visitdate desc,p.first,p.last;

GPRORPVSearchByDateOfVisit= select top 10 p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT ', P-' + aa.PQRSNo \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')) \
and pvv.serviceprovideruid is null and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].pqrsgprosubmission where PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pv.serviceprovideruid is null \
and CONVERT(VARCHAR(24),pv.visitdate,110) = '@searchkey' \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid order by pv.visitdate desc,p.first,p.last;

GPRORPVSearchByReportedMeasures= select * from ( \
select top 10 p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT ', P-' + aa.PQRSNo \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')) \
and pvv.serviceprovideruid is null and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].pqrsgprosubmission where PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pv.serviceprovideruid is null \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid ) \
search where reportedmeasures like '%@searchkey%' order by dateofvisit desc,firstname,lastname;

GPRORPVSortByMrn= select top 10 p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT ', P-' + aa.PQRSNo \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')) \
and pvv.serviceprovideruid is null and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].pqrsgprosubmission where PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pv.serviceprovideruid is null \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid \
order by p.medicalrecordnumber @sortmethod,dateofvisit desc;

GPRORPVPagination=WITH OrderedRecords AS \
(select ROW_NUMBER()OVER (order by pv.visitdate desc,p.first,p.last) AS Rownumber, \
p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT ', P-' + aa.PQRSNo \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')) \
and pvv.serviceprovideruid is null and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].pqrsgprosubmission where PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pv.serviceprovideruid is null \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid) \
SELECT * FROM OrderedRecords WHERE RowNumber BETWEEN (((@pagenumber-1)*10)+ 1) AND @pagenumber*10;

ReportedPatientVisitsCount=select count(*) totalcount from( \
select p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT ', P-' + aa.PQRSNo \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')) \
and pvv.serviceprovideruid is null and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].pqrsgprosubmission where PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pv.serviceprovideruid is null \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid)counttable;


GPROAdvancedStatusView= SELECT top 5 '#P-'+pqm.PQRSNO measure,sum(md.EligibleInstance) eligible,sum(md.MetInstance) met,sum(md.NotMetInstance) notMet,sum(md.NA) notApplicable ,sum(md.ExclusionInstance) exclusion \
FROM [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit v ON v.PQRSPatientUid=p.PQRSPatientUid \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSVisitMeasureDetails md ON md.PQRSPatientVisitUid = v.PQRSPatientVisitUid \
join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROqualitymeasure pqm on md.PQRSGPROqualitymeasureUid=pqm.PQRSGPROqualitymeasureUid \
WHERE p.practiceuid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pqm.PQRSGPROqualitymeasureUid in \
 (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].pqrsgprosubmission where PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')))) \
and v.serviceprovideruid is null \
group by pqm.PQRSNO order by cast(pqm.PQRSNO as int);

GPROAdvancedStatusPagination= WITH OrderedRecords AS \
(select ROW_NUMBER()OVER (order by cast(pqm.PQRSNO as int)) AS Rownumber, \
'#P-'+pqm.PQRSNO measure,sum(md.EligibleInstance) eligible,sum(md.MetInstance) met,sum(md.NotMetInstance) notMet,sum(md.NA) notApplicable ,sum(md.ExclusionInstance) exclusion \
FROM [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit v ON v.PQRSPatientUid=p.PQRSPatientUid \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSVisitMeasureDetails md ON md.PQRSPatientVisitUid = v.PQRSPatientVisitUid \
join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROqualitymeasure pqm on md.PQRSGPROqualitymeasureUid=pqm.PQRSGPROqualitymeasureUid \
WHERE p.practiceuid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pqm.PQRSGPROqualitymeasureUid in \
 (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].pqrsgprosubmission where PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')))) \
and v.serviceprovideruid is null \
group by pqm.PQRSNO) \
SELECT * FROM OrderedRecords WHERE RowNumber BETWEEN (((@pagenumber-1)*5)+ 1) AND @pagenumber*5;

GPROAdvancedStatusSortByEligible= SELECT top 5 '#P-'+pqm.PQRSNO measure,sum(md.EligibleInstance) eligible,sum(md.MetInstance) met,sum(md.NotMetInstance) notMet,sum(md.NA) notApplicable ,sum(md.ExclusionInstance) exclusion \
FROM [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit v ON v.PQRSPatientUid=p.PQRSPatientUid \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSVisitMeasureDetails md ON md.PQRSPatientVisitUid = v.PQRSPatientVisitUid \
join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROqualitymeasure pqm on md.PQRSGPROqualitymeasureUid=pqm.PQRSGPROqualitymeasureUid \
WHERE p.practiceuid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pqm.PQRSGPROqualitymeasureUid in \
 (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].pqrsgprosubmission where PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')))) \
and v.serviceprovideruid is null \
group by pqm.PQRSNO  \
order by eligible @sortmethod ,cast(pqm.PQRSNO as int);

GPROAdvancedStatusPopupEligible= select top 15 p.first +' '+p.last as name, \
p.medicalrecordnumber as mrn, \
m.description as gender, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateOfVisit, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateOfBirth \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
inner JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSVisitMeasureDetails md ON md.PQRSPatientVisitUid = pv.PQRSPatientVisitUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROqualitymeasure pqm on md.PQRSGPROqualitymeasureUid=pqm.PQRSGPROqualitymeasureUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pv.serviceprovideruid is null \
and pqm.PQRSNO='@measure' and md.EligibleInstance=1 \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid order by pv.visitdate desc,p.first,p.last;

GPROAdvancedStatusPopupEligibleSortByMrn= select top 15 p.first +' '+p.last as name, \
p.medicalrecordnumber as mrn, \
m.description as gender, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateOfVisit, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateOfBirth \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
inner JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSVisitMeasureDetails md ON md.PQRSPatientVisitUid = pv.PQRSPatientVisitUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROqualitymeasure pqm on md.PQRSGPROqualitymeasureUid=pqm.PQRSGPROqualitymeasureUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pv.serviceprovideruid is null \
and pqm.PQRSNO='@measure' and md.EligibleInstance=1 \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid order by  p.medicalrecordnumber @sortmethod,pv.visitdate desc,p.first,p.last;

GPROAdvancedStatusPopupEligiblePagination=WITH OrderedRecords AS \
(select ROW_NUMBER()OVER (order by pv.visitdate desc,p.first,p.last) AS Rownumber, \
 p.first +' '+p.last as name, \
p.medicalrecordnumber as mrn, \
m.description as gender, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateOfVisit, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateOfBirth \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
inner JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSVisitMeasureDetails md ON md.PQRSPatientVisitUid = pv.PQRSPatientVisitUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROqualitymeasure pqm on md.PQRSGPROqualitymeasureUid=pqm.PQRSGPROqualitymeasureUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pv.serviceprovideruid is null \
and pqm.PQRSNO='@measure' and md.EligibleInstance=1 \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid) \
SELECT * FROM OrderedRecords WHERE RowNumber BETWEEN (((@pagenumber-1)*15)+ 1) AND @pagenumber*15;

SelectedGproMeasures=SELECT a.pqrsno as pqrsno, \
a.measurename as measuretitle, \
b.Name as qualitydomain, \
case a.iscrosscuttingmeasure when 0 then 'No' \
ELSE 'Yes' \
END as crosscutting \
from [FIGMDPQRSSubmissionDemo].dbo.PQRSGPROQualityMeasure as a \
inner join PQRSGPROQualityMeasureDomain as b on a.PQRSGPROQualityMeasureDomainUid=b.PQRSGPROQualityMeasureDomainUid \
where a.type=1 \
and a.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].pqrsgprosubmission where PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')))) \
order by CAST(a.pqrsno as integer);

ManageGPROProfileTinView= select top 15 TIN from PracticeTINSplitInfo where PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')) \
and ServiceProviderUid is NULL \
and ValidFromDate is NULL \
and ValidTodate is NULL order by Cast(TIN as int);

#Dashboard>>Provider
querytobeadded=  select top 15 isnull(providername,'')name ,Denominator AS exceeding,Numerator as below FROM  \
 [FIGMDWeb].[dbo].ViewMeasureComputationSummary
 
ProviderGridView=select top 15 ' '+a.name as name ,sum(exceeding) exceeding,sum(below) below \
from ( \
select name, \
case when Difference > 0 then 1 else 0 end 'exceeding', \
case when Difference <= 0 then 1 else 0 end 'below' ,msc.measureid \
from [FIGMDHQIManagement].[dbo].Viewserviceprovider vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.ServiceProviderUid=msc.Provideruid and msc.QuarterName='2014Q2' and flag='@flag' \
and msc.provideruid is not null and locationuid is  null \
inner join dbo.FIGUserAuthorization fa \
on fa.ObjectUid = vf.ServiceProviderUid and type in ('1','3') and \
OBJECtname = 'provider' AND fa.figuseruid \
IN(SELECT figuseruid FROM figuser WHERE loginname = '@loginuser') \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0 ) a   group by name
 
ProviderGridViewNR=select top 15 ' '+a.name as name,sum(exceeding) exceeding,sum(below) below \
from ( \
select name, \
case when Difference > 0 then 1 else 0 end 'exceeding', \
case when Difference <= 0 then 1 else 0 end 'below' ,msc.measureid \
from [FIGMDHQIManagement].[dbo].Viewserviceprovider vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.ServiceProviderUid=msc.Provideruid and msc.QuarterName='2014Q2' and flag='@flag' \
and msc.provideruid is not null and locationuid is  null \
inner join dbo.FIGUserAuthorization fa \
on fa.ObjectUid = vf.ServiceProviderUid and type in ('1','3') and \
OBJECtname = 'provider' AND fa.figuseruid \
IN(SELECT figuseruid FROM figuser WHERE loginname = '@loginuser') \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0 ) a   group by name

 
 querytobeaddedpagination=  WITH OrderedRecords AS \
(select ROW_NUMBER()OVER (order by providername) AS Rownumber, \
 isnull(providername,'')name ,Denominator AS exceeding,Numerator as below FROM  \
 [FIGMDWeb].[dbo].ViewMeasureComputationSummary) \
SELECT * FROM OrderedRecords WHERE RowNumber BETWEEN (((@pagenumber-1)*15)+ 1) AND @pagenumber*15;

ProviderPagination=WITH OrderedRecords AS \
(select ROW_NUMBER()OVER (order by a.providerName) AS Rownumber, a.providerName name,sum(exceeding) exceeding,sum(below) below \
from ( \
select ProviderUid,ProviderName,MeasureId, \
case when Difference >= 0 then 1 else 0 end 'exceeding', \
case when Difference < 0 then 1 else 0 end 'below' \
from [FIGMDWeb].[dbo].viewserviceProvider vsp \
inner join [FIGMDWeb].[dbo].ViewMeasureComputationSummary vmsc on vsp.serviceprovideruid=vmsc.provideruid \
where  vmsc.PracticeUid='3A24533F-2471-4B34-9370-6B5749304216' \
and quartername='2014Q2' and flag='QR' \
and locationuid is  null and provideruid is  not null and providername is not null \
and type in ( 1,3) and inactive=0 ) a \
group by providerName) \
SELECT * FROM OrderedRecords WHERE RowNumber BETWEEN (((@pagenumber-1)*15)+ 1) AND @pagenumber*15;


ProviderPaginationNR=WITH OrderedRecords AS \
(select ROW_NUMBER()OVER (order by a.providerName) AS Rownumber, a.providerName name,sum(exceeding) exceeding,sum(below) below \
from ( \
select ProviderUid,ProviderName,MeasureId, \
case when Difference >= 0 then 1 else 0 end 'exceeding', \
case when Difference < 0 then 1 else 0 end 'below' \
from [FIGMDWeb].[dbo].viewserviceProvider vsp \
inner join [FIGMDWeb].[dbo].ViewMeasureComputationSummary vmsc on vsp.serviceprovideruid=vmsc.provideruid \
where  vmsc.PracticeUid='3A24533F-2471-4B34-9370-6B5749304216' \
and quartername='2014Q2' and flag='QNR' \
and locationuid is  null and provideruid is  not null and providername is not null \
and type in ( 1,3) and inactive=0 ) a \
group by providerName) \
SELECT * FROM OrderedRecords WHERE RowNumber BETWEEN (((@pagenumber-1)*15)+ 1) AND @pagenumber*15;

 
querytobeaddedprovidercount=select count(distinct provideruid) totalcount from [FIGMDWeb].[dbo].ViewMeasureComputationSummary where practiceuid in \
(select practiceuid from individual where individualuid in(select figuseruid from figuser where loginname like '@loginuser') ) \
and QuarterName='2014Q2';

ProviderCount=select Count(distinct a.name) as totalcount \
from ( \
select name, \
case when Difference > 0 then 1 else 0 end 'exceeding', \
case when Difference <= 0 then 1 else 0 end 'below' ,msc.measureid \
from [FIGMDHQIManagement].[dbo].Viewserviceprovider vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.ServiceProviderUid=msc.Provideruid and msc.QuarterName='@quartermonth' and flag='@flag' \
and msc.provideruid is not null and locationuid is  null \
inner join dbo.FIGUserAuthorization fa \
on fa.ObjectUid = vf.ServiceProviderUid and type in ('1','3') and \
OBJECtname = 'provider' AND fa.figuseruid \
IN(SELECT figuseruid FROM figuser WHERE loginname = '@loginuser') \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0 ) a

ProviderCountNR=select Count(distinct a.name) as totalcount \
from ( \
select name, \
case when Difference > 0 then 1 else 0 end 'exceeding', \
case when Difference <= 0 then 1 else 0 end 'below' ,msc.measureid \
from [FIGMDHQIManagement].[dbo].Viewserviceprovider vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.ServiceProviderUid=msc.Provideruid and msc.QuarterName='2014Q2' and flag='@flag' \
and msc.provideruid is not null and locationuid is  null \
inner join dbo.FIGUserAuthorization fa \
on fa.ObjectUid = vf.ServiceProviderUid and type in ('1','3') and \
OBJECtname = 'provider' AND fa.figuseruid \
IN(SELECT figuseruid FROM figuser WHERE loginname = '@loginuser') \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0 ) a


measurequerytobeadded=  select top 15 \
DisplayName+' '+MeasureId measureID, \
Measure measureName, \
'(Registry Benchmark: '+cast (Cast(BenchMark as numeric(10,2)) as varchar)+'%)' registryBenchmark, \
cast (Cast(Average as numeric(10,2)) as varchar)+'%'performance \
 from [FIGMDWeb].[dbo].ViewMeasureComputationSummary;
 
ProviderMeasureView=select distinct NationalProgramQualityMeasureUid, \
case DisplayName when 'APA' then  ' APA'+MeasureId when 'APA' then ' APA'+MeasureId end as MeasureId, \
replace (replace(replace(replace(measure,char(10),' '),char(13),' '),'  ',' '),'in Melanoma ','in Melanoma')  as measureName, \
'(Registry Benchmark: '+CAST(CONVERT(DECIMAL(10,2),NationalAverage*100 ) AS varchar)+'%)' as registryBenchmark, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+'%' as performance, \
ListOrder \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') and QuarterName='2014Q2' and Flag = '@flag' \
and ProviderUid ='@provideruid' and LocationUid is null order by ListOrder

ProviderMeasureViewNR=select distinct NationalProgramQualityMeasureUid, \
case DisplayName when 'APA' then  ' APA'+MeasureId when 'APA' then ' APA'+MeasureId end as MeasureId, \
replace (replace(replace(replace(measure,char(10),' '),char(13),' '),'  ',' '),'in Melanoma ','in Melanoma')  as measureName, \
'(Registry Benchmark: '+CAST(CONVERT(DECIMAL(10,2),NationalAverage*100 ) AS varchar)+'%)' as registryBenchmark, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+'%' as performance, \
ListOrder \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') and QuarterName='2014Q2' and Flag = '@flag' \
and ProviderUid ='@provideruid' and LocationUid is null order by ListOrder
 
 
querytobeaddedproviderpatietndrilldown=select top 15 p.first +' '+p.last as name, \
p.medicalrecordnumber as mrn, \
m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dob \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
inner JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSVisitMeasureDetails md ON md.PQRSPatientVisitUid = pv.PQRSPatientVisitUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROqualitymeasure pqm on md.PQRSGPROqualitymeasureUid=pqm.PQRSGPROqualitymeasureUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pv.serviceprovideruid is null  and md.EligibleInstance=1 \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.PQRSPatientVisitUid order by p.first,p.last;

ProviderPatientDrillDownSort=select top 15 Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob, \
ROW_NUMBER() OVER(order by name) AS Rownumber \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderrollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='28ac16f8-bca4-4d11-a726-3b055d7d31ea' \
and ProviderUid ='d57bdd2e-b73d-4e02-a3be-48085e438dcf' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by mrn desc

ProviderPatientDrillDownSortNR=select top 15 Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob, \
ROW_NUMBER() OVER(order by name) AS Rownumber \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='28ac16f8-bca4-4d11-a726-3b055d7d31ea' \
and ProviderUid ='d57bdd2e-b73d-4e02-a3be-48085e438dcf' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by mrn desc

ProviderPatientDrillDownViewNR=DECLARE  @RowspPage AS INT \
SET @RowspPage = 15 \
SELECT * FROM ( \
select Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob, \
ROW_NUMBER() OVER(order by name) AS Rownumber \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='28ac16f8-bca4-4d11-a726-3b055d7d31ea' \
and ProviderUid ='d57bdd2e-b73d-4e02-a3be-48085e438dcf' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )  ) AS TBL \
WHERE Rownumber BETWEEN ((1 - 1) * @RowspPage + 1) AND (1 * @RowspPage)

ProviderPatientDrillDownView=DECLARE  @RowspPage AS INT \
SET @RowspPage = 15 \
SELECT * FROM ( \
select Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob, \
ROW_NUMBER() OVER(order by name) AS Rownumber \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderrollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='28ac16f8-bca4-4d11-a726-3b055d7d31ea' \
and ProviderUid ='d57bdd2e-b73d-4e02-a3be-48085e438dcf' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )  ) AS TBL \
WHERE Rownumber BETWEEN ((1 - 1) * @RowspPage + 1) AND (1 * @RowspPage)

ProviderPatientDrillDownPaginationNR=DECLARE  @RowspPage AS INT \
SET @RowspPage = 15 \
SELECT * FROM ( \
select Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob, \
ROW_NUMBER() OVER(order by name) AS Rownumber \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='28ac16f8-bca4-4d11-a726-3b055d7d31ea' \
and ProviderUid ='d57bdd2e-b73d-4e02-a3be-48085e438dcf' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )  ) AS TBL \
WHERE Rownumber BETWEEN ((@pagenumber - 1) * @RowspPage + 1) AND (@pagenumber * @RowspPage)

ProviderPatientDrillDownPagination=DECLARE  @RowspPage AS INT \
SET @RowspPage = 15 \
SELECT * FROM ( \
select Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob, \
ROW_NUMBER() OVER(order by name) AS Rownumber \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderrollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='28ac16f8-bca4-4d11-a726-3b055d7d31ea' \
and ProviderUid ='d57bdd2e-b73d-4e02-a3be-48085e438dcf' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )  ) AS TBL \
WHERE Rownumber BETWEEN ((@pagenumber - 1) * @RowspPage + 1) AND (@pagenumber * @RowspPage)

ProviderPatientDrillDownCountNR=select Count(mrn) as totalcount \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='28ac16f8-bca4-4d11-a726-3b055d7d31ea' \
and ProviderUid ='d57bdd2e-b73d-4e02-a3be-48085e438dcf' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )

ProviderPatientDrillDownCount=select Count(mrn) as totalcount \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderrollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='28ac16f8-bca4-4d11-a726-3b055d7d31ea' \
and ProviderUid ='d57bdd2e-b73d-4e02-a3be-48085e438dcf' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )

querytobeaddedmeasuresummarycomputation=select top 4 \
QuarterName as monQuat, \
Denominator as allmeasures, \
NationalNotMet as met, \
NotMet as notmet, \
Numerator as percentage \
from [FIGMDWeb].[dbo].ViewMeasureComputationSummary;

ProviderMeasureComputationSummaryView=select QuarterName monquat,Denominator allmeasures,Numerator met,NotMet notmet, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+' %' as percentage from [FIGMDWeb].[dbo].ViewMeasureComputationSummary \
where PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser')\
and flag='@flag' \
and ProviderUid='@provideruid' \
and NationalProgramQualityMeasureUid='@measureuid' \
and locationuid is  null and provideruid is  not null and providername is not null order by QuarterName desc

ProviderMeasureComputationSummaryViewNR=select QuarterName monquat,Denominator allmeasures,Numerator met,NotMet notmet, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+' %' as percentage from [FIGMDWeb].[dbo].ViewMeasureComputationSummary \
where PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser')\
and flag='@flag' \
and ProviderUid='@provideruid' \
and NationalProgramQualityMeasureUid='@measureuid' \
and locationuid is  null and provideruid is  not null and providername is not null order by QuarterName desc


#############        PQRS SUBMISSION SUBMISSSION 2015         ###############


ManageProviderProfileSelectProviderView=DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = 1 SET @RowspPage = 15 \
select * from ( \
select distinct vsp.Name,vsp.EmailAddress,vsp.npi, \
CASE pro.ReportingType \
WHEN '2' Then case IsNPIValidated when 1 Then 'Individual Measures Reporting' else '' end \
WHEN '3' Then case IsNPIValidated when 1 Then 'Cataracts Measures Group Reporting'  else '' end \
WHEN '4' Then case IsNPIValidated when 1 Then 'Qualified Clinical Data Registry Reporting'  else '' end \
else '' \
end  as REPORTINGTYPE, \
ROW_NUMBER() OVER(order by vsp.Name,REPORTINGTYPE) as Rownumber \
from ViewServiceProvider vsp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission sub on sub.ServiceProviderUid=vsp.ServiceProviderUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfile pro on pro.PQRSGPROProfileUid=sub.PQRSGPROProfileUid \
where  vsp.type in('1','3') and inactive ='0' and \
vsp.ServiceProviderUid in \
(select distinct objectuid from figuser fu \
inner join figuserauthorization fua on fua.figuseruid = fu.figuseruid and  fua.ObjectName ='Provider' \
inner join individual i on i.individualuid = fu.figuseruid \
where loginname like 'Practice.admin') ) tbl \
where Rownumber between ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage)order by Rownumber,REPORTINGTYPE;


ManageProviderProfileSelectProviderSearch=DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = 1 SET @RowspPage = 300 \
select * from ( \
select distinct vsp.Name,vsp.EmailAddress,vsp.npi, \
CASE pro.ReportingType \
WHEN '2' Then case IsNPIValidated when 1 Then 'Individual Measures Reporting' else '' end \
WHEN '3' Then case IsNPIValidated when 1 Then 'Cataracts Measures Group Reporting'  else '' end \
WHEN '4' Then case IsNPIValidated when 1 Then 'Qualified Clinical Data Registry Reporting'  else '' end \
else '' \
end  as REPORTINGTYPE, \
ROW_NUMBER() OVER(order by vsp.Name,REPORTINGTYPE) as Rownumber \
from ViewServiceProvider vsp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission sub on sub.ServiceProviderUid=vsp.ServiceProviderUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfile pro on pro.PQRSGPROProfileUid=sub.PQRSGPROProfileUid \
where  vsp.type in('1','3') and inactive ='0' and \
vsp.ServiceProviderUid in \
(select distinct objectuid from figuser fu \
inner join figuserauthorization fua on fua.figuseruid = fu.figuseruid and  fua.ObjectName ='Provider' \
inner join individual i on i.individualuid = fu.figuseruid \
where loginname like 'Practice.admin') ) tbl \
where Rownumber between ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage) and  REPORTINGTYPE like 'ind%' \
order by Rownumber,REPORTINGTYPE;

ManageProviderProfileSelectProviderSort=select distinct top 15 vsp.Name,vsp.EmailAddress,vsp.npi, \
CASE pro.ReportingType \
WHEN '2' Then case IsNPIValidated when 1 Then 'Individual Measures Reporting' else '' end \
WHEN '3' Then case IsNPIValidated when 1 Then 'Cataracts Measures Group Reporting'  else '' end \
WHEN '4' Then case IsNPIValidated when 1 Then 'Qualified Clinical Data Registry Reporting'  else '' end \
else '' \
end  as REPORTINGTYPE \
from ViewServiceProvider vsp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission sub on sub.ServiceProviderUid=vsp.ServiceProviderUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfile pro on pro.PQRSGPROProfileUid=sub.PQRSGPROProfileUid \
where  vsp.type in('1','3') and inactive ='0' and \
vsp.ServiceProviderUid in \
(select distinct objectuid from figuser fu \
inner join figuserauthorization fua on fua.figuseruid = fu.figuseruid and  fua.ObjectName ='Provider' \
inner join individual i on i.individualuid = fu.figuseruid \
where loginname like 'Practice.admin') order by Npi

ManageProviderProfileSelectProviderPagination=DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = @currentPage SET @RowspPage = 15 \
select * from ( \
select distinct vsp.Name,vsp.EmailAddress,vsp.npi, \
CASE pro.ReportingType \
WHEN '2' Then case IsNPIValidated when 1 Then 'Individual Measures Reporting' else '' end \
WHEN '3' Then case IsNPIValidated when 1 Then 'Cataracts Measures Group Reporting'  else '' end \
WHEN '4' Then case IsNPIValidated when 1 Then 'Qualified Clinical Data Registry Reporting'  else '' end \
else '' \
end  as REPORTINGTYPE, \
ROW_NUMBER() OVER(order by vsp.Name,REPORTINGTYPE) as Rownumber \
from ViewServiceProvider vsp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission sub on sub.ServiceProviderUid=vsp.ServiceProviderUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfile pro on pro.PQRSGPROProfileUid=sub.PQRSGPROProfileUid \
where  vsp.type in('1','3') and inactive ='0' and \
vsp.ServiceProviderUid in \
(select distinct objectuid from figuser fu \
inner join figuserauthorization fua on fua.figuseruid = fu.figuseruid and  fua.ObjectName ='Provider' \
inner join individual i on i.individualuid = fu.figuseruid \
where loginname like 'Practice.admin') ) tbl \
where Rownumber between ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage) order by Rownumber,REPORTINGTYPE;

TaxIdentificationNumberView=select TIN,CONVERT(VARCHAR(11),ValidFromDate,110) as ValidFromDate,CONVERT(VARCHAR(11), \
ValidTodate,110) as ValidTodate from [dbo].[PracticeTINSplitInfo] \
where practiceuid ='3A24533F-2471-4B34-9370-6B5749304216' and ServiceProviderUid='c1c7d30a-acaf-473a-9df1-891d78838c6d';

TaxIdentificationNumberSort=select TIN,CONVERT(VARCHAR(11),ValidFromDate,110) as ValidFromDate,CONVERT(VARCHAR(11), \
ValidTodate,110) as ValidTodate from [dbo].[PracticeTINSplitInfo] \
where practiceuid ='3A24533F-2471-4B34-9370-6B5749304216' and ServiceProviderUid='c1c7d30a-acaf-473a-9df1-891d78838c6d' order by TIN

ReportedPatientVisitsCMGRPagination=DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = @currentPage SET @RowspPage = 10 \
select * from(select p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
case mt.value when 1 then 'Yes' \
when 2 then 'No' \
else mt.value end Medicare, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, case pv.OperativeEye when \
'OperativeEyeRight' then 'Right' else 'Left' end OperativeEye, \
ROW_NUMBER() OVER(order by pv.visitdate desc,p.first,p.last) as Rownumber \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on \
pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].multitable mt on p.MultiTableUid=mt.MultiTableUid \
where p.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like 'Practice.admin')) \
and pv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider \
where listname = 'Provider15,Demotest s') \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,OperativeEye,p.PQRSPatientUid,mt.value ) tbl \
where Rownumber between ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage);

ReportedPatientVisitsCMGRSearch=DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = 1 SET @RowspPage = 10 \
select * from(select p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
case mt.value when 1 then 'Yes' \
when 2 then 'No' \
else mt.value end Medicare, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, case pv.OperativeEye when \
'OperativeEyeRight' then 'Right' else 'Left' end OperativeEye, \
ROW_NUMBER() OVER(order by pv.visitdate desc) as Rownumber \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on \
pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].multitable mt on p.MultiTableUid=mt.MultiTableUid \
where p.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like 'Practice.admin')) \
and pv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider \
where listname = 'Provider15,Demotest s') \
and p.medicalrecordnumber like '@search%' \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,OperativeEye,p.PQRSPatientUid,mt.value ) tbl \
where Rownumber between ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage);

ReportedPatientVisitsCMGRSort=select TOP 10 p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
case mt.value when 1 then 'Yes' \
when 2 then 'No' \
else mt.value end Medicare, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, case pv.OperativeEye \
when 'OperativeEyeRight' then 'Right' else 'Left' end OperativeEye \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on \
pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].multitable mt on p.MultiTableUid=mt.MultiTableUid \
where p.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like 'Practice.admin')) \
and pv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where \
listname = 'Provider15,Demotest s') group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,OperativeEye,p.PQRSPatientUid,mt.value order by p.medicalrecordnumber

ReportedPatientVisitsCMGRView=select top 10 p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, case mt.value when 1 then 'Yes' when 2 then 'No'\
else mt.value end Medicare, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, case pv.OperativeEye when 'OperativeEyeRight' then \
'Right' else 'Left' end OperativeEye \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on \
pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].multitable mt on p.MultiTableUid=mt.MultiTableUid \
where p.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like 'Practice.admin')) \
and pv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'Provider15,Demotest s') \
group by p.first,p.last,m.description,p.birthdate,p.medicalrecordnumber, \
pv.visitdate,OperativeEye,p.PQRSPatientUid,mt.value order by pv.visitdate desc;

ReportedPatientVisitsCMGRCount=select Count(p.first) \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on \
pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].multitable mt on p.MultiTableUid=mt.MultiTableUid \
where p.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like 'Practice.admin')) \
and pv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider \
where listname = 'Provider15,Demotest s')


	
ReportedPatientVisitsQCDRRView=select top 10  p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, case mt.value when 1 then 'Yes' \
when 2 then 'No' \
else mt.value end Medicare, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT Case When aa.type='4' then ',I-' + aa.PQRSNo else ',P-' + aa.pqrsno end \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like 'Practice.admin')) \
and pvv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'Provider1,Demo M') and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission \
where serviceprovideruid in (select serviceprovideruid from serviceprovider where listname='Provider1,Demo M'))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].multitable mt on p.MultiTableUid=mt.MultiTableUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like 'Practice.admin')) \
and pv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'Provider1,Demo M') \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid,mt.value order by pv.visitdate desc,p.first,p.last;

ReportedPatientVisitsQCDRRPagination=DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = @currentPage SET @RowspPage = 10 \
select * from( \
select p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, case mt.value when 1 then 'Yes' \
when 2 then 'No' \
else mt.value end Medicare, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT Case When aa.type='4' then ',I-' + aa.PQRSNo else ',P-' + aa.pqrsno end \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like 'Practice.admin')) \
and pvv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'Provider1,Demo M') and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission \
where serviceprovideruid in (select serviceprovideruid from serviceprovider where listname='Provider1,Demo M'))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures, \
ROW_NUMBER() OVER(order by pv.visitdate desc,p.first,p.last) as Rownumber \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].multitable mt on p.MultiTableUid=mt.MultiTableUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like 'Practice.admin')) \
and pv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'Provider1,Demo M') \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid,mt.value ) tbl \
where Rownumber between ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage);

ReportedPatientVisitsQCDRRRSearch=DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = 1 SET @RowspPage = 10 \
select * from( \
select p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, case mt.value when 1 then 'Yes' \
when 2 then 'No' \
else mt.value end Medicare, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT Case When aa.type='4' then ',I-' + aa.PQRSNo else ',P-' + aa.pqrsno end \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like 'Practice.admin')) \
and pvv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'Provider1,Demo M') and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission \
where serviceprovideruid in (select serviceprovideruid from serviceprovider where listname='Provider1,Demo M'))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures, \
ROW_NUMBER() OVER(order by pv.visitdate desc,p.first,p.last) as Rownumber \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].multitable mt on p.MultiTableUid=mt.MultiTableUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like 'Practice.admin')) \
and pv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'Provider1,Demo M') \
and  p.medicalrecordnumber like '@searchkey%' \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid,mt.value ) tbl \
where Rownumber between ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage);

ReportedPatientVisitsQCDRRSort=DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = 1 SET @RowspPage = 10 \
select * from( \
select p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, case mt.value when 1 then 'Yes' \
when 2 then 'No' \
else mt.value end Medicare, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT Case When aa.type='4' then ',I-' + aa.PQRSNo else ',P-' + aa.pqrsno end \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like 'Practice.admin')) \
and pvv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'Provider1,Demo M') and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission \
where serviceprovideruid in (select serviceprovideruid from serviceprovider where listname='Provider1,Demo M'))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures, \
ROW_NUMBER() OVER(order by p.medicalrecordnumber asc,p.first,p.last) as Rownumber \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].multitable mt on p.MultiTableUid=mt.MultiTableUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like 'Practice.admin')) \
and pv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'Provider1,Demo M') \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid,mt.value ) tbl \
where Rownumber between ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage);

ReportedPatientVisitsQCDRRCount=select Count(*) From ( \
select p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, case mt.value when 1 then 'Yes' \
when 2 then 'No' \
else mt.value end Medicare, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT Case When aa.type='4' then ', I-' + aa.PQRSNo else ', P-' + aa.pqrsno end \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like 'Practice.admin')) \
and pvv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'Provider1,Demo M') and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission \
where serviceprovideruid in (select serviceprovideruid from serviceprovider where listname='Provider1,Demo M'))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].multitable mt on p.MultiTableUid=mt.MultiTableUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like 'Practice.admin')) \
and pv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'Provider1,Demo M') \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid, \
mt.value) tbls


PqrsAdvancedStatusIMRView=SELECT top 5 '#P-'+pqm.PQRSNO measure,sum(md.EligibleInstance) eligible,sum(md.MetInstance) met, \
sum(md.NotMetInstance) notMet,sum(md.NA) notApplicable ,sum(md.ExclusionInstance) exclusion \
FROM [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit v ON v.PQRSPatientUid=p.PQRSPatientUid \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSVisitMeasureDetails md ON md.PQRSPatientVisitUid = v.PQRSPatientVisitUid \
join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROqualitymeasure pqm on md.PQRSGPROqualitymeasureUid=pqm.PQRSGPROqualitymeasureUid \
WHERE p.practiceuid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like 'Practice.admin')) \
and v.ServiceProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
and pqm.PQRSGPROqualitymeasureUid in \
(select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission \
where serviceprovideruid in (select serviceprovideruid from serviceprovider where listname='AAODEMO,TEST'))) \
and v.ServiceProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
group by pqm.PQRSNO order by cast(pqm.PQRSNO as int);

PqrsAdvancedStatusSearch=

PqrsAdvancedStatusPagination=

PqrsReportingOptionIMRView=SELECT a.pqrsno as pqrsno, \
a.measurename as measuretitle, \
b.Name as qualitydomain, \
case a.iscrosscuttingmeasure when 0 then 'No' \
ELSE 'Yes' \
END as crosscutting \
from [FIGMDPQRSSubmissionDemo].dbo.PQRSGPROQualityMeasure as a \
LEFT join PQRSGPROQualityMeasureDomain as b on a.PQRSGPROQualityMeasureDomainUid=b.PQRSGPROQualityMeasureDomainUid \
where a.type=1 \
order by CAST(a.pqrsno as integer);

PqrsReportingOptionCMGRView=SELECT a.pqrsno as pqrsno, \
a.measurename as measuretitle, \
b.Name as qualitydomain, \
case a.iscrosscuttingmeasure when 0 then '' \
ELSE '' \
END as crosscutting \
from [FIGMDPQRSSubmissionDemo].dbo.PQRSGPROQualityMeasure as a \
LEFT join PQRSGPROQualityMeasureDomain as b on a.PQRSGPROQualityMeasureDomainUid=b.PQRSGPROQualityMeasureDomainUid \
where a.type=2 \
order by CAST(a.pqrsno as integer);

PqrsReportingOptionQCDRRView=select * from ( \
SELECT  Distinct Case When a.type='4' then 'APA-' + a.pqrsno  else 'PQRS ' + a.pqrsno end as pqrsno, \
a.measurename as measuretitle, \
b.Name as qualitydomain, \
case a.iscrosscuttingmeasure when 0 then 'No' \
when 1 then 'Yes' \
END as crosscutting \
from [FIGMDPQRSSubmissionDemo].dbo.PQRSGPROQualityMeasure as a \
LEFT join PQRSGPROQualityMeasureDomain as b on a.PQRSGPROQualityMeasureDomainUid=b.PQRSGPROQualityMeasureDomainUid \
where a.type in (1,4)) a \
order by len(pqrsno),pqrsno

CountIndividualMeasuresReporting=SELECT count(*) \
from [FIGMDPQRSSubmissionDemo].dbo.PQRSGPROQualityMeasure as a \
LEFT join PQRSGPROQualityMeasureDomain as b on a.PQRSGPROQualityMeasureDomainUid=b.PQRSGPROQualityMeasureDomainUid \
where a.type=1 

CountQualifiedClinicalDataRegistryReporting = SELECT  Distinct count( measurename) \
from [FIGMDPQRSSubmissionDemo].dbo.PQRSGPROQualityMeasure as a \
LEFT join PQRSGPROQualityMeasureDomain as b on a.PQRSGPROQualityMeasureDomainUid=b.PQRSGPROQualityMeasureDomainUid where a.type in (1,4)

CountCataractsMeasuresGroupReporting =SELECT Count(a.pqrsno ) \
from [FIGMDPQRSSubmissionDemo].dbo.PQRSGPROQualityMeasure as a \
LEFT join PQRSGPROQualityMeasureDomain as b on a.PQRSGPROQualityMeasureDomainUid=b.PQRSGPROQualityMeasureDomainUid \
where a.type=2 

CountTaxIdentificationNumber=select count(TIN) from [dbo].[PracticeTINSplitInfo] \
where practiceuid ='3A24533F-2471-4B34-9370-6B5749304216' and ServiceProviderUid='c1c7d30a-acaf-473a-9df1-891d78838c6d';

ReportedPatientVisitsIMRView=select top 10 p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT ', P-' + aa.PQRSNo \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like 'Practice.admin')) \
and pvv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'AAODEMO,TEST') and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission \
where serviceprovideruid in (select serviceprovideruid from serviceprovider where listname='AAODEMO,TEST'))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like 'Practice.admin')) \
and pv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'AAODEMO,TEST') \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid order by pv.visitdate desc,p.first,p.last;

ReportedPatientVisitsIMRSearch=DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = 1 SET @RowspPage = 10 \
select * from(select top 10 p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT ', P-' + aa.PQRSNo \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like '@loginuser')) \
and pvv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'AAODEMO,TEST') and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission \
where serviceprovideruid in (select serviceprovideruid from serviceprovider where listname='AAODEMO,TEST'))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures, \
ROW_NUMBER() OVER(order by pv.visitdate desc) as Rownumber \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser')) \
and pv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'AAODEMO,TEST') \
and  p.medicalrecordnumber like '@searchkey%' \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid order by pv.visitdate desc,p.first,p.last) tbl \
where Rownumber between ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage);

ReportedPatientVisitsIMRSort=select top 10 p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT ', P-' + aa.PQRSNo \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like 'Practice.admin')) \
and pvv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'AAODEMO,TEST') and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission \
where serviceprovideruid in (select serviceprovideruid from serviceprovider where listname='AAODEMO,TEST'))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like 'Practice.admin')) \
and pv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'AAODEMO,TEST') \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid order by p.medicalrecordnumber @sortmethod,p.first,p.last ;

ReportedPatientVisitsIMRPagination=DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = @currentPage SET @RowspPage = 10 \
select * from( \
select p.first as firstname,p.last as lastname,m.description as gender, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit,\
isnull(STUFF((SELECT ', P-' + aa.PQRSNo \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like 'Practice.admin')) \
and pvv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'AAODEMO,TEST') and \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission \
where serviceprovideruid in (select serviceprovideruid from serviceprovider where listname='AAODEMO,TEST'))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures, \
ROW_NUMBER() OVER(order by pv.visitdate desc) as Rownumber \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like 'Practice.admin')) \
and pv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'AAODEMO,TEST') \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid ) tbl \
where Rownumber between ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage);

ReportedPatientVisitsIMRCount= select count(*) from( \
select p.first as firstname,p.last as lastname, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateofbirth, \
p.medicalrecordnumber as mrn, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateofvisit, \
isnull(STUFF((SELECT ', P-' + aa.PQRSNo \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient pp \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pvv on pp.PQRSPatientUid=pvv.PQRSPatientUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmdd on pmdd.PQRSPatientVisitUid=pvv.PQRSPatientVisitUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROQualityMeasure aa on aa.PQRSGPROQualityMeasureUid =pmdd.PQRSGPROQualityMeasureUid \
where pp.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like 'Practice.admin')) \
and pvv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'AAODEMO,TEST')  and  \
pvv.PQRSPatientVisitUid =pv.PQRSPatientVisitUid \
and aa.PQRSGPROQualityMeasureUid in (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in (select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].pqrsgprosubmission where PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like 'Practice.admin')))) \
order by cast(aa.PQRSNo as int) \
FOR XML PATH('')), 1, 1, ''),'') as reportedmeasures \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
where p.PracticeUid in \
(select practiceuid from individual where individualuid in \
(select figuseruid from figuser where loginname like 'Practice.admin')) \
and pv.serviceprovideruid in(select top 1 serviceprovideruid from serviceprovider where listname = 'AAODEMO,TEST') \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid ) tbl;

PqrsAdvancedStatusIMRSort= SELECT top 5 '#P-'+pqm.PQRSNO measure,sum(md.EligibleInstance) eligible,sum(md.MetInstance) met, \
 sum(md.NotMetInstance) notMet,sum(md.NA) notApplicable ,sum(md.ExclusionInstance) exclusion \
FROM [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit v ON v.PQRSPatientUid=p.PQRSPatientUid \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSVisitMeasureDetails md ON md.PQRSPatientVisitUid = v.PQRSPatientVisitUid \
join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROqualitymeasure pqm on md.PQRSGPROqualitymeasureUid=pqm.PQRSGPROqualitymeasureUid \
WHERE p.practiceuid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like 'Practice.admin')) \
and v.ServiceProviderUid in(select top 1 serviceprovideruid from serviceprovider where listname = 'AAODEMO,TEST') \
and pqm.PQRSGPROqualitymeasureUid in \
 (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission \
where serviceprovideruid in (select serviceprovideruid from serviceprovider where listname='AAODEMO,TEST'))) \
and v.ServiceProviderUid in(select top 1 serviceprovideruid from serviceprovider where listname = 'AAODEMO,TEST') \
group by pqm.PQRSNO order by cast(pqm.PQRSNO as int) desc;

PqrsAdvancedStatusIMRPagination= DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = @currentPage SET @RowspPage = 5 \
select * from( \
SELECT '#P-'+pqm.PQRSNO measure,sum(md.EligibleInstance) eligible,sum(md.MetInstance) met, \
sum(md.NotMetInstance) notMet,sum(md.NA) notApplicable ,sum(md.ExclusionInstance) exclusion, \
ROW_NUMBER() OVER(order by cast(pqm.PQRSNO as int)) as Rownumber \
FROM [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit v ON v.PQRSPatientUid=p.PQRSPatientUid \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSVisitMeasureDetails md ON md.PQRSPatientVisitUid = v.PQRSPatientVisitUid \
join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROqualitymeasure pqm on md.PQRSGPROqualitymeasureUid=pqm.PQRSGPROqualitymeasureUid \
WHERE p.practiceuid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like 'Practice.admin')) \
and v.ServiceProviderUid in(select top 1 serviceprovideruid from serviceprovider where listname = 'AAODEMO,TEST') \
and pqm.PQRSGPROqualitymeasureUid in \
 (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission \
where serviceprovideruid in (select serviceprovideruid from serviceprovider where listname='AAODEMO,TEST'))) \
and v.ServiceProviderUid in(select top 1 serviceprovideruid from serviceprovider where listname = 'AAODEMO,TEST') \
group by pqm.PQRSNO ) tbl \
where Rownumber between ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage);

PqrsAdvancedStatusQCDRRView=SELECT top 5 Case When pqm.type='4' then '#I-' + pqm.PQRSNo else '#P-' + pqm.pqrsno end as measure, \
sum(md.EligibleInstance) eligible,sum(md.MetInstance) met, \
sum(md.NotMetInstance) notMet,sum(md.NA) notApplicable ,sum(md.ExclusionInstance) exclusion \
FROM [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit v ON v.PQRSPatientUid=p.PQRSPatientUid \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSVisitMeasureDetails md ON md.PQRSPatientVisitUid = v.PQRSPatientVisitUid \
join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROqualitymeasure pqm on md.PQRSGPROqualitymeasureUid=pqm.PQRSGPROqualitymeasureUid \
WHERE p.practiceuid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like 'Practice.admin')) \
and v.ServiceProviderUid in(select top 1 serviceprovideruid from serviceprovider where listname = 'Provider1,Demo M') \
and pqm.PQRSGPROqualitymeasureUid in \
(select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission \
where serviceprovideruid in (select serviceprovideruid from serviceprovider where listname='Provider1,Demo M'))) \
group by pqm.PQRSNO,pqm.type order by cast(pqm.PQRSNO as int);

PqrsAdvancedStatusQCDRRSort= SELECT top 5 Case When pqm.type='4' then '#I-' + pqm.PQRSNo else '#P-' + pqm.pqrsno end as measure, \
sum(md.EligibleInstance) eligible,sum(md.MetInstance) met, \
sum(md.NotMetInstance) notMet,sum(md.NA) notApplicable ,sum(md.ExclusionInstance) exclusion \
FROM [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit v ON v.PQRSPatientUid=p.PQRSPatientUid \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSVisitMeasureDetails md ON md.PQRSPatientVisitUid = v.PQRSPatientVisitUid \
join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROqualitymeasure pqm on md.PQRSGPROqualitymeasureUid=pqm.PQRSGPROqualitymeasureUid \
WHERE p.practiceuid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like 'Practice.admin')) \
and v.ServiceProviderUid in(select top 1 serviceprovideruid from serviceprovider where listname = 'Provider1,Demo M') \
and pqm.PQRSGPROqualitymeasureUid in \
(select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission \
where serviceprovideruid in (select serviceprovideruid from serviceprovider where listname='Provider1,Demo M'))) \
group by pqm.PQRSNO,pqm.type order by cast(pqm.PQRSNO as int) desc;


PqrsAdvancedStatusQCDRRPagination=DECLARE @PageNumber AS INT, \
@RowspPage AS INT SET @PageNumber = @currentPage SET @RowspPage = 5 \
select * from( \
SELECT Case When pqm.type='4' then '#I-' + pqm.PQRSNo else '#P-' + pqm.pqrsno end as measure, \
sum(md.EligibleInstance) eligible,sum(md.MetInstance) met, \
sum(md.NotMetInstance) notMet,sum(md.NA) notApplicable ,sum(md.ExclusionInstance) exclusion, \
ROW_NUMBER() OVER(order by cast(pqm.PQRSNO as int)) as Rownumber \
FROM [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit v ON v.PQRSPatientUid=p.PQRSPatientUid \
JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSVisitMeasureDetails md ON md.PQRSPatientVisitUid = v.PQRSPatientVisitUid \
join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROqualitymeasure pqm on md.PQRSGPROqualitymeasureUid=pqm.PQRSGPROqualitymeasureUid \
WHERE p.practiceuid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like 'Practice.admin')) \
and v.ServiceProviderUid in(select top 1 serviceprovideruid from serviceprovider where listname = 'Provider1,Demo M') \
and pqm.PQRSGPROqualitymeasureUid in \
 (select PQRSGPROQualityMeasureUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfileQualityMeasureMapping \
where PQRSGPROProfileUid in \
(select PQRSGPROProfileUid from [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission \
where serviceprovideruid in (select serviceprovideruid from serviceprovider where listname='Provider1,Demo M'))) \
group by pqm.PQRSNO,pqm.type ) tbl \
where Rownumber between ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage);

PqrsAdvancedStatusCMGRView=SELECT '#'+cast(MeasureID as varchar) as measure , sum(md.Eligible) eligible,sum(md.Met) met, \
sum(md.NotMet) notMet,sum(md.NA) notApplicable ,sum(md.Exclusion) exclusion \
FROM [FIGMDPQRSSubmissionDemo].dbo.[PQRS2015GroupMeasuresCountAnalysis] md \
where serviceprovideruid in (select serviceprovideruid from serviceprovider where listname='Provider15,Demotest s') \
group by MeasureID order by cast(MeasureID as int);

PqrsAdvancedStatusCMGRSort=SELECT '#'+cast(MeasureID as varchar) as measure , sum(md.Eligible) eligible,sum(md.Met) met, \
sum(md.NotMet) notMet,sum(md.NA) notApplicable ,sum(md.Exclusion) exclusion \
FROM [FIGMDPQRSSubmissionDemo].dbo.[PQRS2015GroupMeasuresCountAnalysis] md \
where serviceprovideruid in (select serviceprovideruid from serviceprovider where listname='Provider15,Demotest s') \
group by MeasureID order by cast(MeasureID as int) desc;

GroupPerformanceViewNew=Select ( \
select count(*) from ( \
select * from [FIGMDPQRSSubmissionDemo].dbo.[PQRS2015GroupMeasuresCountAnalysisGroupLevel] where ((Eligible_191 = 1 or NA_191 =1 ) or \
(Eligible_192 = 1 or NA_192 =1 ) or Eligible_303 = 1 or Eligible_304 = 1 or Eligible_130 = 1 or \
Eligible_226 = 1 or (Eligible_388 = 1 or NA_388 =1 ) or (Eligible_389 = 1 or NA_389 =1 )  ) \
and ServiceproviderUid in(select ServiceproviderUid from [[FIGMDHQIManagement]].dbo.Serviceprovider \
where listname = 'Provider15,Demotest s') and GroupEligibleDenominator=1 ) tble)  'GroupDenominator', \
(select count(*) from ( \
select * from [FIGMDPQRSSubmissionDemo].dbo.[PQRS2015GroupMeasuresCountAnalysisGroupLevel] where \
(Met_191=1 or NotMet_191=1  or Na_191=1) and (Met_192=1 or NotMet_192=1  or Na_192=1) and \
(Met_303=1 or NotMet_303=1  or exclusion_303=1) and (Met_304=1 or NotMet_304=1  or exclusion_304=1) \
and (Met_130=1 or NotMet_130=1  or exclusion_130=1) and (Met_226=1 or NotMet_226=1  or exclusion_226=1) \
and (Met_388=1 or NotMet_388=1  or Na_388=1)  and (Met_389=1 or NotMet_389=1  or Na_389=1) \
and ServiceproviderUid in (select ServiceproviderUid from [[FIGMDHQIManagement]].dbo.Serviceprovider \
where listname = 'Provider15,Demotest s') and GroupEligibleNumerator=1 ) tbl )as  'GroupNumerator', \
(select count(GroupMedicare) as GroupMedicare from [FIGMDPQRSSubmissionDemo].dbo.[PQRS2015GroupMeasuresCountAnalysisGroupLevel] \
where ServiceproviderUid in(select ServiceproviderUid from [[FIGMDHQIManagement]].dbo.Serviceprovider \
where listname = 'Provider15,Demotest s') ) as 'GroupMedicare'
 
GroupPerformanceSortNew=Select ( \
select count(*) from ( \
select * from [FIGMDPQRSSubmissionDemo].dbo.[PQRS2015GroupMeasuresCountAnalysisGroupLevel] where ((Eligible_191 = 1 or NA_191 =1 ) or \
(Eligible_192 = 1 or NA_192 =1 ) or Eligible_303 = 1 or Eligible_304 = 1 or Eligible_130 = 1 or \
Eligible_226 = 1 or (Eligible_388 = 1 or NA_388 =1 ) or (Eligible_389 = 1 or NA_389 =1 )  ) \
and ServiceproviderUid in(select ServiceproviderUid from [[FIGMDHQIManagement]].dbo.Serviceprovider \
where listname = 'Provider15,Demotest s') and GroupEligibleDenominator=1 ) tble)  'GroupDenominator', \
(select count(*) from ( \
select * from [FIGMDPQRSSubmissionDemo].dbo.[PQRS2015GroupMeasuresCountAnalysisGroupLevel] where \
(Met_191=1 or NotMet_191=1  or Na_191=1) and (Met_192=1 or NotMet_192=1  or Na_192=1) and \
(Met_303=1 or NotMet_303=1  or exclusion_303=1) and (Met_304=1 or NotMet_304=1  or exclusion_304=1) \
and (Met_130=1 or NotMet_130=1  or exclusion_130=1) and (Met_226=1 or NotMet_226=1  or exclusion_226=1) \
and (Met_388=1 or NotMet_388=1  or Na_388=1)  and (Met_389=1 or NotMet_389=1  or Na_389=1) \
and ServiceproviderUid in (select ServiceproviderUid from [[FIGMDHQIManagement]].dbo.Serviceprovider \
where listname = 'Provider15,Demotest s') and GroupEligibleNumerator=1 ) tbl )as  'GroupNumerator', \
(select count(GroupMedicare) as GroupMedicare from [FIGMDPQRSSubmissionDemo].dbo.[PQRS2015GroupMeasuresCountAnalysisGroupLevel] \
where ServiceproviderUid in(select ServiceproviderUid from [[FIGMDHQIManagement]].dbo.Serviceprovider \
where listname = 'Provider15,Demotest s') ) as 'GroupMedicare'

PqrsAdvancedStatusEligiblePopupView=select top 15 p.first +' '+p.last as name, \
p.medicalrecordnumber as mrn, \
m.description as gender, \
CONVERT(VARCHAR(24),pv.visitdate,110) as dateOfVisit, \
CONVERT(VARCHAR(24),p.birthdate,110) as dateOfBirth \
from [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatient p \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSPatientVisit pv on p.PQRSPatientUid=pv.PQRSPatientUid \
inner join mastergender m on p.gender=m.genderuid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PqrsVisitMeasureDetails pmd on pmd.PQRSPatientVisitUid=pv.PQRSPatientVisitUid \
inner JOIN [FIGMDPQRSSubmissionDemo].[dbo].PQRSVisitMeasureDetails md ON md.PQRSPatientVisitUid = pv.PQRSPatientVisitUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROqualitymeasure pqm on md.PQRSGPROqualitymeasureUid=pqm.PQRSGPROqualitymeasureUid \
where p.PracticeUid in \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where individualuid in \
(select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like 'Practice.admin')) \
and pv.serviceprovideruid in(select serviceprovideruid from serviceprovider where listname ='AAODEMO,TEST') \
and pqm.PQRSNO='12' and md.EligibleInstance=1 \
group by p.first, \
p.last,m.description,p.birthdate,p.medicalrecordnumber,pv.visitdate,pv.PQRSPatientVisitUid order by pv.visitdate desc,p.first,p.last;

ProviderSubmissionView=select distinct top 15 vsp.Name as ProviderName, \
CASE pro.ReportingType \
WHEN '2' Then case IsNPIValidated when 1 Then 'Individual Measures Reporting' else '' end \
WHEN '3' Then case IsNPIValidated when 1 Then 'Cataracts Measures Group Reporting'  else '' end \
WHEN '4' Then case IsNPIValidated when 1 Then 'Qualified Clinical Data Registry Reporting'  else '' end \
end  as ReportingOption, \
case IsEsigned \
when '1' then case IsInactive when '0' then 'Signed' end else 'Sign DRCF Now' end as DRCFStatus, \
case IsNPIValidated when 1 then 'Submit' end as SubmissionStatus, \
ROW_NUMBER() OVER(order by vsp.Name) as Rownumber \
from ViewServiceProvider vsp \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission sub on sub.ServiceProviderUid=vsp.ServiceProviderUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfile pro on pro.PQRSGPROProfileUid=sub.PQRSGPROProfileUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].[ProviderEchosignDocumentDetails] sig on sig.ServiceProviderUid=vsp.ServiceProviderUid \
where  vsp.type in('1','3') and inactive ='0' and pro.ReportingType in('2','3','4') and IsNPIValidated ='1' and \
IsInactive = '0' and \
vsp.ServiceProviderUid in \
(select distinct objectuid from figuser fu \
inner join figuserauthorization fua on fua.figuseruid = fu.figuseruid and  fua.ObjectName ='Provider' \
inner join individual i on i.individualuid = fu.figuseruid \
where loginname like 'Practice.admin') order by vsp.Name,ReportingOption desc

ProviderSubmissionPagination=select distinct top 15 vsp.Name as ProviderName, \
CASE pro.ReportingType \
WHEN '2' Then case IsNPIValidated when 1 Then 'Individual Measures Reporting' else '' end \
WHEN '3' Then case IsNPIValidated when 1 Then 'Cataracts Measures Group Reporting'  else '' end \
WHEN '4' Then case IsNPIValidated when 1 Then 'Qualified Clinical Data Registry Reporting'  else '' end \
end  as ReportingOption, \
case IsEsigned \
when '1' then case IsInactive when '0' then 'Signed' end else 'Sign DRCF Now' end as DRCFStatus, \
case IsNPIValidated when 1 then 'Submit' end as SubmissionStatus, \
ROW_NUMBER() OVER(order by vsp.Name) as Rownumber \
from ViewServiceProvider vsp \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission sub on sub.ServiceProviderUid=vsp.ServiceProviderUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfile pro on pro.PQRSGPROProfileUid=sub.PQRSGPROProfileUid \
inner join [FIGMDPQRSSubmissionDemo].[dbo].[ProviderEchosignDocumentDetails] sig on sig.ServiceProviderUid=vsp.ServiceProviderUid \
where  vsp.type in('1','3') and inactive ='0' and pro.ReportingType in('2','3','4') and IsNPIValidated ='1' and \
IsInactive = '0' and \
vsp.ServiceProviderUid in \
(select distinct objectuid from figuser fu \
inner join figuserauthorization fua on fua.figuseruid = fu.figuseruid and  fua.ObjectName ='Provider' \
inner join individual i on i.individualuid = fu.figuseruid \
where loginname like 'Practice.admin') order by vsp.Name,ReportingOption desc

ProviderSubmissionCount=select Count (vsp.ServiceProviderUid) \
from ViewServiceProvider vsp \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROSubmission sub on sub.ServiceProviderUid=vsp.ServiceProviderUid \
left join [FIGMDPQRSSubmissionDemo].[dbo].PQRSGPROProfile pro on pro.PQRSGPROProfileUid=sub.PQRSGPROProfileUid \
where  vsp.type in('1','3') and inactive ='0' and pro.ReportingType in('2','3','4') and IsNPIValidated ='1' and \
vsp.ServiceProviderUid in \
(select distinct objectuid from figuser fu \
inner join figuserauthorization fua on fua.figuseruid = fu.figuseruid and  fua.ObjectName ='Provider' \
inner join individual i on i.individualuid = fu.figuseruid \
where loginname like 'Practice.admin')

###################    RPC >> MAP
MapCount=select count(FederalTaxID) from Practice where ExternalID='000013'

ResetpracticekeyView=SELECT P.ExternalID AS practiceID,P.ListName AS practiceName,CASE I.IsConnected WHEN 0 THEN 'No' else 'Yes' END AS registrationKeyInUse, \
Format(I.ModifiedDate,'M/dd/yyyy h:mm:ss tt') as lastAccessTime \
FROM PRACTICE P INNER JOIN [dbo].[Instance] I \
ON I.InstanceUID=P.InstanceUID WHERE PRACTICEUID IN \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where \
individualuid in (select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginName'))


ResetpracticekeySort=SELECT P.ExternalID AS practiceID,P.ListName AS practiceName,CASE I.IsConnected WHEN 0 THEN 'No' else 'Yes' END AS registrationKeyInUse, \
Format(I.ModifiedDate,'M/dd/yyyy h:mm:ss tt') as lastAccessTime \
FROM PRACTICE P INNER JOIN [dbo].[Instance] I \
ON I.InstanceUID=P.InstanceUID WHERE PRACTICEUID IN \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where \
individualuid in (select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginName'))

ResetpracticekeyCount=(select count(practiceuid)as practiceuid from [FIGMDHQIManagement].[dbo].individual where \
individualuid in (select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like '@loginuser'))

ResetpracticekeySearch=SELECT P.ExternalID AS practiceID,P.ListName AS practiceName,CASE I.IsConnected WHEN 0 THEN 'No' else 'Yes' END AS registrationKeyInUse, \
Format(I.ModifiedDate,'M/dd/yyyy h:mm:ss tt') as lastAccessTime \
FROM PRACTICE P INNER JOIN [dbo].[Instance] I \
ON I.InstanceUID=P.InstanceUID WHERE PRACTICEUID IN \
(select practiceuid from [FIGMDHQIManagement].[dbo].individual where \
individualuid in (select figuseruid from [FIGMDHQIManagement].[dbo].figuser where loginname like 'Practice.admin')) \
and P.ExternalID like '@searchvalue%'

DashboardLocation=select Distinct locationName, \
Sum(Case when Difference<0 or Difference=0 then 0 else 1 end)as Exceeding, \
Sum(Case when Difference>=0 then 0 else 1 end) as below \
from [ViewMeasureComputationSummary] vmcs \
inner  JOIN [10.20.201.116].[FIGMDHQIManagement].[dbo].Institution ins \
ON ins.Institutionuid = vmcs.locationuid \
where ins.PracticeUid='3A24533F-2471-4B34-9370-6B5749304216' \
and Flag='qr' and QuarterName='2014Q2' \
and locationuid is not null \
and Inactive =0 and Type=5 \
group by locationName

DashboardLocationCount=SELECT COUNT(Distinct InstitutionUid) FROM [10.20.201.116].[FIGMDHQIManagement].[dbo].Institution  Ins \
INNER JOIN [10.20.201.116].[FIGMDHQIManagement].[dbo].individual i ON i.PracticeUid=Ins.PracticeUid \
INNER JOIN  [10.20.201.116].[FIGMDHQIManagement].[dbo].FigUser   fg ON fg.FIGUserUid=i.IndividualUid \
INNER JOIN [ViewMeasureComputationSummary] vmcs ON  ins.Institutionuid = vmcs.locationuid \
WHERE LoginName ='practice.admin'

DashboardLocationpagination= DECLARE  @RowspPage AS INT \
SET @RowspPage = 15 \
SELECT * FROM ( select Distinct locationName, \
Sum(Case when Difference<0 or Difference=0 then 0 else 1 end)as Exceeding, \
Sum(Case when Difference>=0 then 0 else 1 end) as below , \
ROW_NUMBER() OVER(ORDER BY locationName) AS Rownumber  \
from [ViewMeasureComputationSummary] vmcs \
inner  JOIN [10.20.201.116].[FIGMDHQIManagement].[dbo].Institution ins ON ins.Institutionuid = vmcs.locationuid \
where ins.PracticeUid='3A24533F-2471-4B34-9370-6B5749304216' \
and Flag='qr' and QuarterName='2014Q2' \
and locationuid is not null \
and Inactive =0 and Type=5 \
group by locationName ) AS TBL \
WHERE Rownumber BETWEEN ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage)

DashboardLocationMeasureView =Select  vmc.QuarterName as monquat ,vmc.Denominator as allmeasures ,vmc.Numerator as met,vmc.NotMet as notmet \
,cast(cast((vmc.Average *100)as decimal(5,2)) as varchar(100))+' %'  percentage \
from [10.20.201.116].[FIGMDWeb].dbo.viewmeasurecomputationsummary vmc \
where vmc.practiceUid='3A24533F-2471-4B34-9370-6B5749304216' \
and NationalProgramQualityMeasureUid='D4494222-69FA-44F6-8055-9139D73B3CF3' \
and vmc.locationUid ='a8098834-5df8-49ed-a929-ea2c313cbb50' \
and Flag='QR' \
order by vmc.Average

DashboardProviderCount=SELECT COUNT(Distinct provideruid)  FROM [10.20.201.116].[FIGMDHQIManagement].[dbo].viewserviceprovider sp \
INNER JOIN [10.20.201.116].[FIGMDHQIManagement].[dbo].individual i ON i.PracticeUid=sp.PracticeUid \
INNER JOIN  [10.20.201.116].[FIGMDHQIManagement].[dbo].FigUser   fg ON fg.FIGUserUid=i.IndividualUid \
INNER JOIN [10.20.201.116].[FIGMDWeb].[dbo].[ViewMeasureComputationSummary] vmcs ON  sp.serviceprovideruid = vmcs.provideruid \
WHERE LoginName ='practice.admin'

DashboardProvider= SELECT Distinct Providername,\
Sum(Case when Difference<0 or Difference=0 then 0 else 1 end)as Exceeding, \
Sum(Case when Difference>=0 then 0 else 1 end) as below \
 FROM [10.20.201.116].[FIGMDHQIManagement].[dbo].viewserviceprovider sp \
INNER JOIN [10.20.201.116].[FIGMDHQIManagement].[dbo].individual i ON i.PracticeUid=sp.PracticeUid \
INNER JOIN  [10.20.201.116].[FIGMDHQIManagement].[dbo].FigUser   fg ON fg.FIGUserUid=i.IndividualUid \
INNER JOIN [ViewMeasureComputationSummary] vmcs ON  sp.serviceprovideruid = vmcs.provideruid \
WHERE LoginName ='practice.admin' \
and  sp.PracticeUid='3A24533F-2471-4B34-9370-6B5749304216' \
and Flag='qr' and QuarterName='2014Q2' \
group by Providername



DashboardLocationCount=SELECT COUNT(Distinct InstitutionUid) FROM [10.20.201.116].[FIGMDHQIManagement].[dbo].Institution  Ins \
INNER JOIN [10.20.201.116].[FIGMDHQIManagement].[dbo].individual i ON i.PracticeUid=Ins.PracticeUid \
INNER JOIN  [10.20.201.116].[FIGMDHQIManagement].[dbo].FigUser   fg ON fg.FIGUserUid=i.IndividualUid \
INNER JOIN [ViewMeasureComputationSummary] vmcs ON  ins.Institutionuid = vmcs.locationuid \
WHERE LoginName ='practice.admin'



DashboardLocationMeasureView =Select  vmc.QuarterName as monquat ,vmc.Denominator as allmeasures ,vmc.Numerator as met,vmc.NotMet as notmet \
,cast(cast((vmc.Average *100)as decimal(5,2)) as varchar(100))+' %'  percentage \
from [10.20.201.116].[FIGMDWeb].dbo.viewmeasurecomputationsummary vmc \
where vmc.practiceUid='3A24533F-2471-4B34-9370-6B5749304216' \
and NationalProgramQualityMeasureUid='D4494222-69FA-44F6-8055-9139D73B3CF3' \
and vmc.locationUid ='a8098834-5df8-49ed-a929-ea2c313cbb50' \
and Flag='QR' \
order by vmc.Average

DashboardProviderCount=SELECT COUNT(Distinct provideruid)  FROM [10.20.201.116].[FIGMDHQIManagement].[dbo].viewserviceprovider sp \
INNER JOIN [10.20.201.116].[FIGMDHQIManagement].[dbo].individual i ON i.PracticeUid=sp.PracticeUid \
INNER JOIN  [10.20.201.116].[FIGMDHQIManagement].[dbo].FigUser   fg ON fg.FIGUserUid=i.IndividualUid \
WHERE fg.LoginName ='practice.admin' and sp.inactive = '0'

DashboardaALLProviderCount=SELECT COUNT(Distinct provideruid)  FROM [10.20.201.116].[FIGMDHQIManagement].[dbo].viewserviceprovider sp \
INNER JOIN [10.20.201.116].[FIGMDHQIManagement].[dbo].individual i ON i.PracticeUid=sp.PracticeUid \
INNER JOIN  [10.20.201.116].[FIGMDHQIManagement].[dbo].FigUser   fg ON fg.FIGUserUid=i.IndividualUid \
WHERE fg.LoginName ='practice.admin' and sp.inactive = '0'

DashboardProvider= SELECT Distinct Providername,\
Sum(Case when Difference<0 or Difference=0 then 0 else 1 end)as Exceeding, \
Sum(Case when Difference>=0 then 0 else 1 end) as below \
 FROM [10.20.201.116].[FIGMDHQIManagement].[dbo].viewserviceprovider sp \
INNER JOIN [10.20.201.116].[FIGMDHQIManagement].[dbo].individual i ON i.PracticeUid=sp.PracticeUid \
INNER JOIN  [10.20.201.116].[FIGMDHQIManagement].[dbo].FigUser   fg ON fg.FIGUserUid=i.IndividualUid \
INNER JOIN [ViewMeasureComputationSummary] vmcs ON  sp.serviceprovideruid = vmcs.provideruid \
WHERE LoginName ='practice.admin' \
and  sp.PracticeUid='3A24533F-2471-4B34-9370-6B5749304216' \
and Flag='qr' and QuarterName='2014Q2' \
group by Providername




PracticeMeasureViewR=select distinct \
case DisplayName when 'APA' then  'APA'+MeasureId when 'APA' then 'APA'+MeasureId end as MeasureId, \
replace (replace(replace(replace(measure,char(10),' '),char(13),' '),'  ',' '),'in Melanoma ','in Melanoma')  as measureName, \
'(Registry Benchmark: '+CAST(CONVERT(DECIMAL(10,2),NationalAverage*100 ) AS varchar)+'%)' as registryBenchmark, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+'%' as performance, \
ListOrder \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') and QuarterName='2014Q2' and Flag = '@flag' \
and ProviderUid is null and LocationUid is null order by ListOrder

PracticeMeasureCountR=select distinct Count(MeasureId) as totalcount \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') and QuarterName='2014Q2' and Flag = '@flag' \
and ProviderUid is null and LocationUid is null




PracticeFavoritesMeasureViewR=select distinct \
case DisplayName when 'APA' then  'APA'+MeasureId when 'APA' then 'APA'+MeasureId end as MeasureId, \
replace (replace(replace(replace(measure,char(10),' '),char(13),' '),'  ',' '),'in Melanoma ','in Melanoma')  as measureName, \
'(Registry Benchmark: '+CAST(CONVERT(DECIMAL(10,2),NationalAverage*100 ) AS varchar)+'%)' as registryBenchmark, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+'%' as performance,ListOrder \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] v \
inner join [FIGMDWeb].[dbo].FIGUserFavorite f on f.Value = v.NationalProgramQualityMeasureUid \
where PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') and QuarterName='2014Q2' and Flag = '@flag' \
and ProviderUid is null and LocationUid is null AND f.FIGUserUid in(select FIGUserUid from figuser where loginname ='@loginuser') \
AND f.PageName = 'MEASURE' order by ListOrder

#PracticeFavoritesMeasureViewNR=select distinct \
#case DisplayName when 'APA' then  'APA'+MeasureId when 'APA' then 'APA'+MeasureId end as MeasureId, \
#Measure as measureName, \
#'(Registry Benchmark: '+CAST(CONVERT(DECIMAL(10,2),NationalAverage*100 ) AS varchar)+'%)' as registryBenchmark, \
#CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+'%' as performance,ListOrder \
#from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] v \
#inner join [FIGMDWeb].[dbo].FIGUserFavorite f on f.Value = v.NationalProgramQualityMeasureUid \
#where PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
#on f.Figuseruid = i.individualuid \
#where loginname ='@loginuser') and QuarterName='2014Q2' and Flag = '@flag' \
#and ProviderUid is null and LocationUid is null AND f.FIGUserUid in(select FIGUserUid from figuser where loginname ='@loginuser') \
#AND f.PageName = 'MEASURE' order by ListOrder

PracticeFavoritesMeasureCountR=select distinct Count(Measure) as totalcount \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] v \
inner join [FIGMDWeb].[dbo].FIGUserFavorite f on f.Value = v.NationalProgramQualityMeasureUid \
where PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') and QuarterName='2014Q2' and Flag = '@flag' \
and ProviderUid is null and LocationUid is null AND f.FIGUserUid in(select FIGUserUid from figuser where loginname ='@loginuser') \
AND f.PageName = 'MEASURE'

PracticeFavoritesMeasureCountNR=select distinct Count(Measure) as totalcount \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] v \
inner join [FIGMDWeb].[dbo].FIGUserFavorite f on f.Value = v.NationalProgramQualityMeasureUid \
where PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') and QuarterName='2014Q2' and Flag = '@flag' \
and ProviderUid is null and LocationUid is null AND f.FIGUserUid in(select FIGUserUid from figuser where loginname ='@loginuser') \
AND f.PageName = 'MEASURE'

getSelectrdMeasureUIDonMeasuePopup=select top 1 NationalProgramQualityMeasureUid as measurename \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary]  where  Measure like '%@name%'

PracticeMeasureComputationSummaryViewR=select distinct QuarterName as monquat, Denominator as allmeasures, Numerator as met, NotMet as notmet, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+' %' as percentage \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where NationalProgramQualityMeasureUid='@measureID' and PracticeUid IN \
(select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and Flag = '@flag' \
and ProviderUid is null and LocationUid is null and QuarterName <= '2014Q2' order by QuarterName desc



#########   QUERY
###UPDATED BY AWADHESH
#PracticeLocationPopUpCountR=Select Count(Name) as totalcount \
from [FIGMDHQIManagement].[dbo].ViewFacility where practiceuid='3A24533F-2471-4B34-9370-6B5749304216' AND \
servicelocationuid in ( \
select distinct ServiceLocationUid \
from [FIGMDWeb].[dbo].viewservicelocation vsl \
inner join [FIGMDWeb].[dbo].ViewMeasureComputationSummary vmcs on vsl.PracticeUid=vmcs.PracticeUid \
where vmcs.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and QuarterName='2016Q1' and flag='@flag' \
and locationuid is  not null and provideruid is  null \
and NationalProgramQualityMeasureUid='d3eeaefc-e462-476d-8eb4-b062c5274d59' and inactive = '0')

PracticeLocationPopUpCountR=Select Count(Name) as totalcount \
from [FIGMDHQIManagement].[dbo].ViewFacility where \
servicelocationuid in ( \
select distinct ServiceLocationUid \
from [FIGMDWeb].[dbo].viewservicelocation vsl \
inner join [FIGMDWeb].[dbo].ViewMeasureComputationSummary vmcs on vsl.PracticeUid=vmcs.PracticeUid \
where vmcs.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and QuarterName='2016Q1' and flag='@flag' \
and locationuid is  not null and provideruid is  null \
and NationalProgramQualityMeasureUid='@measureID' and inactive = '0')



####Updated by Awadhesh

#PracticeLocationPopUpViewR=select top 15 ServiceLocationUid,Name as LocationName, \
isNull(Denominator,0) as Qualified, \
isNull(Numerator,0) as Met, \
isNull(NotMet,0) as NotMet, \
CAST(CONVERT(DECIMAL(10,2),isnull(Average,0)*100) AS varchar)+'%' as performance, \
'Registry Average: '+CAST(CONVERT(DECIMAL(10,2),isnull(NationalAverage,0)*100 ) AS varchar)+'%' as registryBenchmark \
from [FIGMDHQIManagement].[dbo].ViewFacility vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.ServiceLocationUid=msc.locationuid and msc.QuarterName='2014Q2' and flag='@flag' \
and msc.locationuid is  not null and provideruid is  null \
and msc.NationalProgramQualityMeasureUid='d3eeaefc-e462-476d-8eb4-b062c5274d59' \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0 \
order by name

PracticeLocationPopUpViewR=select top 15 ServiceLocationUid,Name as LocationName, \
isNull(Denominator,0) as Qualified, \
isNull(Numerator,0) as Met, \
isNull(NotMet,0) as NotMet, \
CAST(CONVERT(DECIMAL(10,2),isnull(Average,0)*100) AS varchar)+'%' as performance, \
'Registry Average: '+CAST(CONVERT(DECIMAL(10,2),isnull(NationalAverage,0)*100 ) AS varchar)+'%' as registryBenchmark \
from [FIGMDHQIManagement].[dbo].ViewFacility vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.ServiceLocationUid=msc.locationuid and msc.QuarterName= '@quartermonth' and flag='@flag' \
and msc.locationuid is  not null and provideruid is  null \
and msc.NationalProgramQualityMeasureUid='@measureID' \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0 \
order by name



#PracticeLocationPopUpViewR=select top 15 ServiceLocationUid,Name as LocationName, \
isNull(Denominator,0) as Qualified, \
isNull(Numerator,0) as Met, \
isNull(NotMet,0) as NotMet, \
CAST(CONVERT(DECIMAL(10,2),isnull(Average,0)*100) AS varchar)+'%' as performance, \
'Registry Average: '+CAST(CONVERT(DECIMAL(10,2),isnull(NationalAverage,0)*100 ) AS varchar)+'%' as registryBenchmark \
from [FIGMDHQIManagement].[dbo].ViewFacility vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.ServiceLocationUid=msc.locationuid and msc.QuarterName='2014Q2' and flag='@flag' \
and msc.locationuid is  not null and provideruid is  null \
and msc.NationalProgramQualityMeasureUid='@measureID' \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0 \
order by name

PracticeLocationPopUpPaginationR=DECLARE  @RowspPage AS INT \
SET @RowspPage = 15 \
SELECT * FROM ( \
select ServiceLocationUid,Name as LocationName, \
isNull(Denominator,0) as Qualified, \
isNull(Numerator,0) as Met, \
isNull(NotMet,0) as NotMet, \
CAST(CONVERT(DECIMAL(10,2),isnull(Average,0)*100) AS varchar)+'%' as performance, \
'Registry Average: '+CAST(CONVERT(DECIMAL(10,2),isnull(NationalAverage,0)*100 ) AS varchar)+'%' as registryBenchmark, \
ROW_NUMBER() OVER(order by name) AS Rownumber \
from [FIGMDHQIManagement].[dbo].ViewFacility vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.ServiceLocationUid=msc.locationuid and msc.QuarterName='2014Q2' and flag='@flag' \
and msc.locationuid is  not null and provideruid is  null \
and msc.NationalProgramQualityMeasureUid='@measureID' \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0 ) AS TBL \
WHERE Rownumber BETWEEN ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage)



#PracticeLocationPopUpViewNR=select \
#LocationName as LocationName,Denominator as Qualified,Numerator as Met,NotMet as NotMet, \
#cast(BenchMark*100 as decimal(5,2)) Performance, \
#cast(NationalAverage*100 as decimal(5,2)) RegistryBenchmark \
#from [FIGMDWeb].[dbo].ViewMeasureComputationSummary \
#where  PracticeUid='3A24533F-2471-4B34-9370-6B5749304216' \
#and QuarterName='2014Q2' and flag='QR' \
#and locationuid is  not null and provideruid is  null \
#and NationalProgramQualityMeasureUid='D4494222-69FA-44F6-8055-9139D73B3CF3' \
#order by LocationName

#PracticeLocationPopUpPaginationNR=select \
#LocationName as LocationName,Denominator as Qualified,Numerator as Met,NotMet as NotMet, \
#cast(BenchMark*100 as decimal(5,2)) Performance, \
#cast(NationalAverage*100 as decimal(5,2)) RegistryBenchmark \
#from [FIGMDWeb].[dbo].ViewMeasureComputationSummary \
#where  PracticeUid='3A24533F-2471-4B34-9370-6B5749304216' \
#and QuarterName='2014Q2' and flag='QR' \
#and locationuid is  not null and provideruid is  null \
#and NationalProgramQualityMeasureUid='D4494222-69FA-44F6-8055-9139D73B3CF3' \
#order by LocationName

#PracticeLocationPopUpCountNR=select \
#count(LocationName) as totalcount \
#from [FIGMDWeb].[dbo].ViewMeasureComputationSummary \
#where  PracticeUid='3A24533F-2471-4B34-9370-6B5749304216' \
#and QuarterName='2014Q2' and flag='QR' \
#and locationuid is  not null and provideruid is  null \
#and NationalProgramQualityMeasureUid='D4494222-69FA-44F6-8055-9139D73B3CF3'


#changed as a temporary fix the below query is correct
####updated 12/07/2017
PracticePatientDrillDownCountR=select Count(mrn) as totalcount \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [10.20.201.188].[FIGMDWebPartition_58].[dbo].MeasureComputationPracticerollingquarterly where \
practiceUid ='3A24533F-2471-4B34-9370-6B5749304216' \
and MeasureUid='@measureID' \
AND quarterEndDate in ('2016-03-31 00:00:00.000') and Notmet='0' )


PracticePatientDrillDownViewR=select top 15 Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationPracticerollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by Name

PracticePatientDrillDownSortR=select top 15 Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationPracticerollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by mrn @sortmethod

PracticePatientDrillDownPaginationR=DECLARE  @RowspPage AS INT \
SET @RowspPage = 15 \
SELECT * FROM ( \
select Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob, \
ROW_NUMBER() OVER(order by name) AS Rownumber \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationPracticerollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) ) AS TBL \
WHERE Rownumber BETWEEN ((@pagenumber - 1) * @RowspPage + 1) AND (@pagenumber * @RowspPage)

PracticeLocationPatientDrillDownCountR=select Count (MRN) as totalcount \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationLocationrollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and locationUid ='a8098834-5df8-49ed-a929-ea2c313cbb50' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )

PracticeLocationPatientDrillDownViewR=select top 15 Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationLocationrollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and locationUid ='a8098834-5df8-49ed-a929-ea2c313cbb50' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by name


PracticeLocationPatientDrillDownSortR=select top 15 Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationLocationrollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and locationUid ='a8098834-5df8-49ed-a929-ea2c313cbb50' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by mrn @sortmethod

PracticeLocationPatientDrillDownPaginationR=DECLARE  @RowspPage AS INT \
SET @RowspPage = 15 \
SELECT * FROM ( \
select Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob, \
ROW_NUMBER() OVER(order by name) AS Rownumber \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationLocationrollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and locationUid ='a8098834-5df8-49ed-a929-ea2c313cbb50' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )  ) AS TBL \
WHERE Rownumber BETWEEN ((@pagenumber - 1) * @RowspPage + 1) AND (@pagenumber * @RowspPage)

PracticeProvidersPatientDrillDownViewR=select top 15 Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderrollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and ProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by name

PracticeProvidersPatientDrillDownCountR=select Count(MRN)  as totalcount \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderrollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and ProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )

PracticeProvidersPatientDrillDownSortR=select top 15 Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderrollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and ProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by mrn @sortmethod

PracticeProvidersPatientDrillDownPaginationR=DECLARE  @RowspPage AS INT \
SET @RowspPage = 15 \
SELECT * FROM ( \
select Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob, \
ROW_NUMBER() OVER(order by name) AS Rownumber \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderrollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and ProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )  ) AS TBL \
WHERE Rownumber BETWEEN ((@pagenumber - 1) * @RowspPage + 1) AND (@pagenumber * @RowspPage)


PracticeAllProvidersPatientDrillDownCountR=select Count(MRN)  as totalcount \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderrollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and ProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )

PracticeAllProvidersPatientDrillDownPaginationR=DECLARE  @RowspPage AS INT \
SET @RowspPage = 15 \
SELECT * FROM ( \
select Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob, \
ROW_NUMBER() OVER(order by name) AS Rownumber \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderrollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and ProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )  ) AS TBL \
WHERE Rownumber BETWEEN ((@pagenumber - 1) * @RowspPage + 1) AND (@pagenumber * @RowspPage)

PracticeAllProvidersPatientDrillDownSortR=select top 15 Name as name,MRN as mrn,Gender as gender, replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderrollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and ProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by mrn asc

PracticeAllProvidersPatientDrillDownViewR=select top 15 Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderrollingquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and ProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by name

PracticeAllProvidersPopUpViewR=select distinct top 15 Name as LocationName, \
isNull(Denominator,0) as Qualified, \
isNull(Numerator,0) as Met, \
isNull(NotMet,0) as NotMet, \
CAST(CONVERT(DECIMAL(10,2),isnull(Average,0)*100) AS varchar)+'%' as performance, \
'Registry Average: '+CAST(CONVERT(DECIMAL(10,2),isnull(NationalAverage,0)*100 ) AS varchar)+'%' as registryBenchmark  \
from [FIGMDHQIManagement].[dbo].Viewserviceprovider vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.ServiceProviderUid=msc.Provideruid and msc.QuarterName='2016Q1' and flag='QR' \
and msc.provideruid is not null and locationuid is  null \
and msc.NationalProgramQualityMeasureUid='@measureID' \
inner join dbo.FIGUserAuthorization fa \
on fa.ObjectUid = vf.ServiceProviderUid and type in ('1','3') and \
OBJECtname = 'provider' AND fa.figuseruid \
IN(SELECT figuseruid FROM figuser WHERE loginname = '@loginuser') \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0 \
order by name

#Updated by awadhesh will not work for practic admin user:
#PracticeAllProvidersPopUpCountR=select Count(distinct ServiceProviderUid) as totalcount \
from [FIGMDHQIManagement].[dbo].Viewserviceprovider vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.ServiceProviderUid=msc.Provideruid and msc.QuarterName='2014Q2' and flag='QR' \
and msc.provideruid is not null and locationuid is  null \
and msc.NationalProgramQualityMeasureUid='@measureID' \
inner join dbo.FIGUserAuthorization fa \
on fa.ObjectUid = vf.ServiceProviderUid and type in ('1','3') and \
OBJECtname = 'provider' AND fa.figuseruid \
IN(SELECT figuseruid FROM figuser WHERE loginname = '@loginuser') \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0

# added by awadhesh for practice admin user
PracticeAllProvidersPopUpCountR=select count(distinct serviceprovideruid )as totalcount  from [FIGMDHQIManagement].[dbo].Viewserviceprovider vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc on vf.ServiceProviderUid=msc.Provideruid \
and msc.QuarterName='2016Q1' and flag='QR' and msc.provideruid is not null and locationuid is  null \
and msc.NationalProgramQualityMeasureUid='a68c6835-98a3-4306-9af2-54153f288153' \
inner join dbo.FIGUserAuthorization fa on fa.ObjectUid = vf.ServiceProviderUid \
and type in ('1','3') and OBJECtname = 'provider' \
AND fa.figuseruid IN(SELECT figuseruid FROM figuser \
WHERE loginname = 'practice.admin') \
where  vf.PracticeUid IN (select PracticeUid from Figuser f \
inner join individual i on f.Figuseruid = i.individualuid where loginname ='practice.admin') and vf.inactive=0 


PracticeProvidersPopUpViewR=select distinct top 15 Name as LocationName, \
isNull(Denominator,0) as Qualified, \
isNull(Numerator,0) as Met, \
isNull(NotMet,0) as NotMet, \
CAST(CONVERT(DECIMAL(10,2),isnull(Average,0)*100) AS varchar)+'%' as performance, \
'Registry Average: '+CAST(CONVERT(DECIMAL(10,2),isnull(NationalAverage,0)*100 ) AS varchar)+'%' as registryBenchmark  \
from [FIGMDHQIManagement].[dbo].Viewserviceprovider vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.ServiceProviderUid=msc.Provideruid and msc.QuarterName='2014Q2' and flag='QR' \
and msc.provideruid is   not null and locationuid is  null \
and msc.NationalProgramQualityMeasureUid='@measureID' \
inner join dbo.FIGUserAuthorization fa \
on fa.ObjectUid = vf.ServiceProviderUid and type in ('1','3') and \
OBJECtname = 'provider' AND fa.figuseruid \
IN(SELECT figuseruid FROM figuser WHERE loginname = '@loginuser') \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0 \
order by name

PracticeLocationMeasureComputationSummaryViewR=select distinct QuarterName as monquat, Denominator as allmeasures, Numerator as met, NotMet as notmet, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+' %' as percentage  from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where locationuid='a8098834-5df8-49ed-a929-ea2c313cbb50' \
and  PracticeUid IN \
(select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and Flag = '@flag' \
and ProviderUid is null and QuarterName <= '2014Q2' \
and NationalProgramQualityMeasureUid ='@measureID'order by QuarterName desc

PracticeProviderMeasureComputationSummaryViewR=select distinct QuarterName as monquat, Denominator as allmeasures, Numerator as met, NotMet as notmet, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+' %' as percentage  from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where ProviderUid='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
and  PracticeUid IN \
(select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and Flag = '@flag' \
and locationuid is null and QuarterName <= '2014Q2' \
and NationalProgramQualityMeasureUid ='@measureID'order by QuarterName desc

PracticeAllProvidersMeasureComputationSummaryViewR=select distinct QuarterName as monquat, Denominator as allmeasures, Numerator as met, NotMet as notmet, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+' %' as percentage  from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where ProviderUid='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
and  PracticeUid IN \
(select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and Flag = '@flag' \
and locationuid is null and QuarterName <= '2014Q2' \
and NationalProgramQualityMeasureUid ='@measureID'order by QuarterName desc

PracticeAllPerformanceTrendViewR=select distinct QuarterName as monquat, Denominator as allmeasures, Numerator as met, NotMet as notmet, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+' %' as percentage \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where NationalProgramQualityMeasureUid='@measureID' and PracticeUid IN \
(select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and Flag = '@flag' \
and ProviderUid is null and LocationUid is null and QuarterName <= '2014Q2' order by QuarterName desc


#PracticeLocationPopUpViewNR=select top 15 ServiceLocationUid,Name as LocationName, \
#isNull(Denominator,0) as Qualified, \
#isNull(Numerator,0) as Met, \
#isNull(NotMet,0) as NotMet, \
#CAST(CONVERT(DECIMAL(10,2),isnull(Average,0)*100) AS varchar)+'%' as performance, \
#'Registry Average: '+CAST(CONVERT(DECIMAL(10,2),isnull(NationalAverage,0)*100 ) AS varchar)+'%' as registryBenchmark \
#from [FIGMDHQIManagement].[dbo].ViewFacility vf \
#left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
#on vf.ServiceLocationUid=msc.locationuid and msc.QuarterName='2014Q2' and flag='@flag' \
#and msc.locationuid is  not null and provideruid is  null \
#and msc.NationalProgramQualityMeasureUid='@measureID' \
#where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
#on f.Figuseruid = i.individualuid \
#where loginname ='@loginuser') \
#and vf.inactive=0 \
#order by name
#PracticeLocationPopUpCountNR=Select Count(Name) as totalcount \
#from [FIGMDHQIManagement].[dbo].ViewFacility where practiceuid='3A24533F-2471-4B34-9370-6B5749304216' AND \
#servicelocationuid in ( \
#select distinct ServiceLocationUid \
#from [FIGMDWeb].[dbo].viewservicelocation vsl \
#inner join [FIGMDWeb].[dbo].ViewMeasureComputationSummary vmcs on vsl.PracticeUid=vmcs.PracticeUid \
#where vmcs.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
#on f.Figuseruid = i.individualuid \
#where loginname ='@loginuser') \
#and QuarterName='2014Q2' and flag='@flag' \
#and locationuid is  not null and provideruid is  null \
#and NationalProgramQualityMeasureUid='@measureID' and inactive = '0')
PracticeAllPerformanceTrendViewNR=select distinct QuarterName as monquat, Denominator as allmeasures, Numerator as met, NotMet as notmet, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+' %' as percentage \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where NationalProgramQualityMeasureUid='@measureID' and PracticeUid IN \
(select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and Flag = '@flag' \
and ProviderUid is null and LocationUid is null and QuarterName <= '2014Q2' order by QuarterName desc
PracticeAllProvidersMeasureComputationSummaryViewNR=select distinct QuarterName as monquat, Denominator as allmeasures, Numerator as met, NotMet as notmet, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+' %' as percentage  from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where ProviderUid='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
and  PracticeUid IN \
(select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and Flag = '@flag' \
and locationuid is null and QuarterName <= '2014Q2' \
and NationalProgramQualityMeasureUid ='@measureID'order by QuarterName desc
PracticeAllProvidersPatientDrillDownCountNR=select Count(MRN)  as totalcount \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and ProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )
PracticeAllProvidersPatientDrillDownPaginationNR=DECLARE  @RowspPage AS INT \
SET @RowspPage = 15 \
SELECT * FROM ( \
select Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob, \
ROW_NUMBER() OVER(order by name) AS Rownumber \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and ProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )  ) AS TBL \
WHERE Rownumber BETWEEN ((@pagenumber - 1) * @RowspPage + 1) AND (@pagenumber * @RowspPage)
PracticeAllProvidersPatientDrillDownSortNR=select top 15 Name as name,MRN as mrn,Gender as gender, replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and ProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by mrn asc
PracticeAllProvidersPatientDrillDownViewNR=select top 15 Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and ProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by name

#PracticeAllProvidersPopUpCountNR=select Count(distinct ServiceProviderUid) as totalcount \
from [FIGMDHQIManagement].[dbo].Viewserviceprovider vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.ServiceProviderUid=msc.Provideruid and msc.QuarterName='2014Q2' and flag='@flag' \
and msc.provideruid is not null and locationuid is  null \
and msc.NationalProgramQualityMeasureUid='@measureID' \
inner join dbo.FIGUserAuthorization fa \
on fa.ObjectUid = vf.ServiceProviderUid and type in ('1','3') and \
OBJECtname = 'provider' AND fa.figuseruid \
IN(SELECT figuseruid FROM figuser WHERE loginname = '@loginuser') \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0

######updated by awadhesh# this query is not for all practice user:
#PracticeAllProvidersPopUpCountNR=select Count(distinct ServiceProviderUid) as totalcount \
from [FIGMDHQIManagement].[dbo].Viewserviceprovider vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.ServiceProviderUid=msc.Provideruid and msc.QuarterName='2014Q2' and flag='@flag' \
and msc.provideruid is not null and locationuid is  null \
and msc.NationalProgramQualityMeasureUid='@measureID' \
inner join dbo.FIGUserAuthorization fa \
on fa.ObjectUid = vf.ServiceProviderUid and type in ('1','3') and \
OBJECtname = 'provider' AND fa.figuseruid \
IN(SELECT figuseruid FROM figuser WHERE loginname = '@loginuser') \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0
##updated by awadhesh # this query is for practice admin user: 
PracticeAllProvidersPopUpCountNR=select count(distinct serviceprovideruid )as totalcount  from [FIGMDHQIManagement].[dbo].Viewserviceprovider vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc on vf.ServiceProviderUid=msc.Provideruid \
and msc.QuarterName='2016Q1' and flag='QNR' and msc.provideruid is not null and locationuid is  null \
and msc.NationalProgramQualityMeasureUid='a68c6835-98a3-4306-9af2-54153f288153' \
inner join dbo.FIGUserAuthorization fa on fa.ObjectUid = vf.ServiceProviderUid \
and type in ('1','3') and OBJECtname = 'provider' \
AND fa.figuseruid IN(SELECT figuseruid FROM figuser \
WHERE loginname = 'practice.admin') \
where  vf.PracticeUid IN (select PracticeUid from Figuser f \
inner join individual i on f.Figuseruid = i.individualuid where loginname ='practice.admin') and vf.inactive=0 





















PracticeAllProvidersPopUpViewNR=select distinct top 15 Name as LocationName, isNull(Denominator,0) as Qualified, isNull(Numerator,0) as Met,\
 isNull(NotMet,0) as NotMet, CAST(CONVERT(DECIMAL(10,2),isnull(Average,0)*100) AS varchar)+'%' as performance,\
  'Registry Average: '+CAST(CONVERT(DECIMAL(10,2),isnull(NationalAverage,0)*100 ) AS varchar)+'%' as registryBenchmark \
   from [FIGMDHQIManagement].[dbo].Viewserviceprovider vf left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
   on vf.ServiceProviderUid=msc.Provideruid and msc.QuarterName='2016Q1' and flag='QNR' and msc.provideruid is not null \
   and locationuid is  null and msc.NationalProgramQualityMeasureUid='@measureID' \
   inner join dbo.FIGUserAuthorization fa on fa.ObjectUid = vf.ServiceProviderUid and type in ('1','3') \
   and OBJECtname = 'provider' AND fa.figuseruid IN(SELECT figuseruid FROM figuser WHERE loginname = 'practice.admin') \
   where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i on f.Figuseruid = i.individualuid \
   where loginname ='practice.admin') and Name is not null  and vf.inactive=0 order by name
   
   
   
PracticeFavoritesMeasureViewNR=select distinct \
case DisplayName when 'APA' then  'APA'+MeasureId when 'APA' then 'APA'+MeasureId end as MeasureId, \
Measure as measureName, \
'(Registry Benchmark: '+CAST(CONVERT(DECIMAL(10,2),NationalAverage*100 ) AS varchar)+'%)' as registryBenchmark, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+'%' as performance,ListOrder \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] v \
inner join [FIGMDWeb].[dbo].FIGUserFavorite f on f.Value = v.NationalProgramQualityMeasureUid \
where PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') and QuarterName='2014Q2' and Flag = '@flag' \
and ProviderUid is null and LocationUid is null AND f.FIGUserUid in(select FIGUserUid from figuser where loginname ='@loginuser') \
AND f.PageName = 'MEASURE' order by ListOrder
PracticeLocationMeasureComputationSummaryViewNR=select distinct QuarterName as monquat, Denominator as allmeasures, Numerator as met, NotMet as notmet, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+' %' as percentage  from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where locationuid='a8098834-5df8-49ed-a929-ea2c313cbb50' \
and  PracticeUid IN \
(select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and Flag = '@flag' \
and ProviderUid is null and QuarterName <= '2014Q2' \
and NationalProgramQualityMeasureUid ='@measureID'order by QuarterName desc
PracticeLocationPatientDrillDownCountNR=select Count (MRN) as totalcount \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationLocationquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and locationUid ='a8098834-5df8-49ed-a929-ea2c313cbb50' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )
PracticeLocationPatientDrillDownPaginationNR=DECLARE  @RowspPage AS INT \
SET @RowspPage = 15 \
SELECT * FROM ( \
select Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob, \
ROW_NUMBER() OVER(order by name) AS Rownumber \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationLocationquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and locationUid ='a8098834-5df8-49ed-a929-ea2c313cbb50' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )  ) AS TBL \
WHERE Rownumber BETWEEN ((@pagenumber - 1) * @RowspPage + 1) AND (@pagenumber * @RowspPage)
PracticeLocationPatientDrillDownSortNR=select top 15 Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationLocationquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and locationUid ='a8098834-5df8-49ed-a929-ea2c313cbb50' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by mrn @sortmethod
PracticeLocationPatientDrillDownViewNR=select top 15 Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationLocationquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and locationUid ='a8098834-5df8-49ed-a929-ea2c313cbb50' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by name


#PracticeLocationPopUpCountNR=Select Count(Name) as totalcount \
from [FIGMDHQIManagement].[dbo].ViewFacility vf where vf.practiceuid='3A24533F-2471-4B34-9370-6B5749304216' AND \
vf.servicelocationuid in ( \
select distinct ServiceLocationUid \
from [FIGMDWeb].[dbo].viewservicelocation vsl \
inner join [FIGMDWeb].[dbo].ViewMeasureComputationSummary vmcs on vsl.PracticeUid=vmcs.PracticeUid \
where vmcs.PracticeUid IN (select PracticeUid from [FIGMDHQIManagement].[dbo].Figuser f \
inner join [FIGMDHQIManagement].[dbo].individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and QuarterName='2016Q1' and flag='@flag' \
and locationuid is  not null and provideruid is  null \
and NationalProgramQualityMeasureUid='@measureID' and inactive = '0')

#updated by awadhesh cannot be used for practice admin user 
#PracticeLocationPopUpCountNR=Select Count(Name) as totalcount \
from [FIGMDHQIManagement].[dbo].ViewFacility vf where vf.practiceuid='3A24533F-2471-4B34-9370-6B5749304216' AND \
vf.servicelocationuid in ( \
select distinct ServiceLocationUid \
from [FIGMDWeb].[dbo].viewservicelocation vsl \
inner join [FIGMDWeb].[dbo].ViewMeasureComputationSummary vmcs on vsl.PracticeUid=vmcs.PracticeUid \
where vmcs.PracticeUid IN (select PracticeUid from [FIGMDHQIManagement].[dbo].Figuser f \
inner join [FIGMDHQIManagement].[dbo].individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and QuarterName='2016Q1' and flag='@flag' \
and locationuid is  not null and provideruid is  null \
and NationalProgramQualityMeasureUid='d3eeaefc-e462-476d-8eb4-b062c5274d59' and inactive = '0')

##updated by awadhesh 
####
PracticeLocationPopUpCountNR=Select Count(Name) as totalcount \
from [FIGMDHQIManagement].[dbo].ViewFacility where  \
servicelocationuid in ( \
select distinct ServiceLocationUid \
from [FIGMDWeb].[dbo].viewservicelocation vsl \
inner join [FIGMDWeb].[dbo].ViewMeasureComputationSummary vmcs on vsl.PracticeUid=vmcs.PracticeUid \
where vmcs.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and QuarterName='@quartermonth' and flag='@flag' \
and locationuid is  not null and provideruid is  null \
and NationalProgramQualityMeasureUid='@measureID' and inactive = '0')

PracticeLocationPopUpPaginationNR=DECLARE  @RowspPage AS INT \
SET @RowspPage = 15 \
SELECT * FROM ( \
select ServiceLocationUid,Name as LocationName, \
isNull(Denominator,0) as Qualified, \
isNull(Numerator,0) as Met, \
isNull(NotMet,0) as NotMet, \
CAST(CONVERT(DECIMAL(10,2),isnull(Average,0)*100) AS varchar)+'%' as performance, \
'Registry Average: '+CAST(CONVERT(DECIMAL(10,2),isnull(NationalAverage,0)*100 ) AS varchar)+'%' as registryBenchmark, \
ROW_NUMBER() OVER(order by name) AS Rownumber \
from [FIGMDHQIManagement].[dbo].ViewFacility vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.ServiceLocationUid=msc.locationuid and msc.QuarterName='2014Q2' and flag='@flag' \
and msc.locationuid is  not null and provideruid is  null \
and msc.NationalProgramQualityMeasureUid='@measureID' \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0 ) AS TBL \
WHERE Rownumber BETWEEN ((@PageNumber - 1) * @RowspPage + 1) AND (@PageNumber * @RowspPage)
################
PracticeLocationPopUpViewNR=select top 15 ServiceLocationUid,Name as LocationName, \
isNull(Denominator,0) as Qualified, \
isNull(Numerator,0) as Met, \
isNull(NotMet,0) as NotMet, \
CAST(CONVERT(DECIMAL(10,2),isnull(Average,0)*100) AS varchar)+'%' as performance, \
'Registry Average: '+CAST(CONVERT(DECIMAL(10,2),isnull(NationalAverage,0)*100 ) AS varchar)+'%' as registryBenchmark \
from [FIGMDHQIManagement].[dbo].ViewFacility vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.ServiceLocationUid=msc.locationuid and msc.QuarterName='2014Q2' and flag='@flag' \
and msc.locationuid is  not null and provideruid is  null \
and msc.NationalProgramQualityMeasureUid='@measureID' \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0 \
order by name
##########
PracticeMeasureComputationSummaryViewNR=select distinct QuarterName as monquat, Denominator as allmeasures, Numerator as met, NotMet as notmet, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+' %' as percentage \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where NationalProgramQualityMeasureUid='@measureID' and PracticeUid IN \
(select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and Flag = '@flag' \
and ProviderUid is null and LocationUid is null and QuarterName <= '2014Q2' order by QuarterName desc
PracticeMeasureCountNR=select distinct Count(MeasureId) as totalcount \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') and QuarterName='2014Q2' and Flag = '@flag' \
and ProviderUid is null and LocationUid is null
PracticeMeasureViewNR=select distinct \
case DisplayName when 'APA' then  'APA'+MeasureId when 'APA' then 'APA'+MeasureId end as MeasureId, \
replace (replace(replace(replace(measure,char(10),' '),char(13),' '),'  ',' '),'in Melanoma ','in Melanoma')  as measureName, \
'(Registry Benchmark: '+CAST(CONVERT(DECIMAL(10,2),NationalAverage*100 ) AS varchar)+'%)' as registryBenchmark, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+'%' as performance, \
ListOrder \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') and QuarterName='2014Q2' and Flag = '@flag' \
and ProviderUid is null and LocationUid is null order by ListOrder
PracticePatientDrillDownCountNR=select Count(mrn) as totalcount \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [10.20.201.116].[FIGMDWeb].[dbo].MeasureComputationPracticequarterly where \
practiceUid ='3A24533F-2471-4B34-9370-6B5749304216' \
and MeasureUid='@measureID' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )
PracticePatientDrillDownPaginationNR=DECLARE  @RowspPage AS INT \
SET @RowspPage = 15 \
SELECT * FROM ( \
select Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob, \
ROW_NUMBER() OVER(order by name) AS Rownumber \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationPracticequarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) ) AS TBL \
WHERE Rownumber BETWEEN ((@pagenumber - 1) * @RowspPage + 1) AND (@pagenumber * @RowspPage)
PracticePatientDrillDownSortNR=select top 15 Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationPracticequarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by mrn @sortmethod
PracticePatientDrillDownViewNR=select top 15 Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationPracticequarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by Name
PracticeProviderMeasureComputationSummaryViewNR=select distinct QuarterName as monquat, Denominator as allmeasures, Numerator as met, NotMet as notmet, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+' %' as percentage  from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where ProviderUid='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
and  PracticeUid IN \
(select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and Flag = '@flag' \
and locationuid is null and QuarterName <= '2014Q2' \
and NationalProgramQualityMeasureUid ='@measureID'order by QuarterName desc
PracticeProvidersPatientDrillDownCountNR=select Count(MRN)  as totalcount \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and ProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )
PracticeProvidersPatientDrillDownPaginationNR=DECLARE  @RowspPage AS INT \
SET @RowspPage = 15 \
SELECT * FROM ( \
select Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob, \
ROW_NUMBER() OVER(order by name) AS Rownumber \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and ProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' )  ) AS TBL \
WHERE Rownumber BETWEEN ((@pagenumber - 1) * @RowspPage + 1) AND (@pagenumber * @RowspPage)
PracticeProvidersPatientDrillDownSortNR=select top 15 Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and ProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by mrn @sortmethod
PracticeProvidersPatientDrillDownViewNR=select top 15 Name as name,MRN as mrn,Gender as gender,replace(Convert(varchar, convert(datetime, dob,107), 101),'/','-') as dob \
from [FIGMDWeb].[dbo].webpatients where PatientUid in ( select PatientUid \
from [FIGMDWeb].[dbo].MeasureComputationProviderquarterly where \
practiceUid='3A24533F-2471-4B34-9370-6B5749304216' and MeasureUid='@measureID' \
and ProviderUid ='c1c7d30a-acaf-473a-9df1-891d78838c6d' \
AND quarterEndDate in ('2014-06-30') and Notmet='0' ) order by name
PracticeProvidersPopUpCountNR=select Count(distinct ServiceProviderUid) as totalcount \
from [FIGMDHQIManagement].[dbo].Viewserviceprovider vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.ServiceProviderUid=msc.Provideruid and msc.QuarterName='2014Q2' and flag='QR' \
and msc.provideruid is not null and locationuid is  null \
and msc.NationalProgramQualityMeasureUid='@measureID' \
inner join dbo.FIGUserAuthorization fa \
on fa.ObjectUid = vf.ServiceProviderUid and type in ('1','3') and \
OBJECtname = 'provider' AND fa.figuseruid \
IN(SELECT figuseruid FROM figuser WHERE loginname = '@loginuser') \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0
PracticeProvidersPopUpViewNR=select distinct top 15 Name as LocationName, isNull(Denominator,0) as Qualified, isNull(Numerator,0) as Met,\
 isNull(NotMet,0) as NotMet, CAST(CONVERT(DECIMAL(10,2),isnull(Average,0)*100) AS varchar)+'%' as performance,\
  'Registry Average: '+CAST(CONVERT(DECIMAL(10,2),isnull(NationalAverage,0)*100 ) AS varchar)+'%' as registryBenchmark \
   from [FIGMDHQIManagement].[dbo].Viewserviceprovider vf left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
   on vf.ServiceProviderUid=msc.Provideruid and msc.QuarterName='2016Q1' and flag='QNR' and msc.provideruid is not null \
   and locationuid is  null and msc.NationalProgramQualityMeasureUid='@measureID' \
   inner join dbo.FIGUserAuthorization fa on fa.ObjectUid = vf.ServiceProviderUid and type in ('1','3') \
   and OBJECtname = 'provider' AND fa.figuseruid IN(SELECT figuseruid FROM figuser WHERE loginname = 'practice.admin') \
   where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i on f.Figuseruid = i.individualuid \
   where loginname ='practice.admin') and Name is not null  and vf.inactive=0 order by name
   

##############    DASHBOARD LOCATION   ###############
LocationCountR=Select Count(Name) as totalcount \
from [FIGMDHQIManagement].[dbo].ViewFacility where \
servicelocationuid in ( \
select distinct ServiceLocationUid \
from [FIGMDWeb].[dbo].viewservicelocation vsl \
inner join [FIGMDWeb].[dbo].ViewMeasureComputationSummary vmcs on vsl.PracticeUid=vmcs.PracticeUid \
where vmcs.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and QuarterName='@quartermonth' and flag='@flag' \
and locationuid is  not null and provideruid is  null )

LocationCountNR=Select Count(Name) as totalcount \
from [FIGMDHQIManagement].[dbo].ViewFacility where \
servicelocationuid in ( \
select distinct ServiceLocationUid \
from [FIGMDWeb].[dbo].viewservicelocation vsl \
inner join [FIGMDWeb].[dbo].ViewMeasureComputationSummary vmcs on vsl.PracticeUid=vmcs.PracticeUid \
where vmcs.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and QuarterName='@quartermonth' and flag='@flag' \
and locationuid is  not null and provideruid is  null )

LocationBubbleCountNR=Select Count(Name) as totalcount \
from [FIGMDHQIManagement].[dbo].ViewFacility where \
servicelocationuid in ( \
select distinct ServiceLocationUid \
from [FIGMDWeb].[dbo].viewservicelocation vsl \
inner join [FIGMDWeb].[dbo].ViewMeasureComputationSummary vmcs on vsl.PracticeUid=vmcs.PracticeUid \
where vmcs.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and QuarterName='@quartermonth' and flag='@flag' \
and locationuid is  not null and provideruid is  null )

LocationBubbleCountR=Select Count(Name) as totalcount \
from [FIGMDHQIManagement].[dbo].ViewFacility where \
servicelocationuid in ( \
select distinct ServiceLocationUid \
from [FIGMDWeb].[dbo].viewservicelocation vsl \
inner join [FIGMDWeb].[dbo].ViewMeasureComputationSummary vmcs on vsl.PracticeUid=vmcs.PracticeUid \
where vmcs.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and QuarterName='@quartermonth' and flag='@flag' \
and locationuid is  not null and provideruid is  null )


LocationMeasureCountR=select count (distinct NationalProgramQualityMeasureUid) totalcount \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') and QuarterName='2014Q2' and Flag = '@flag' \
and ProviderUid is null and LocationUid ='@SelectedLocation'

LocationMeasureMeasureComputationSummaryViewR=select QuarterName monquat,Denominator allmeasures,Numerator met,NotMet notmet, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+' %' percentage from [FIGMDWeb].[dbo].ViewMeasureComputationSummary \
where PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and flag='@flag' \
and locationuid='@SelectedLocation' \
and NationalProgramQualityMeasureUid='@LocationMeasureUID' order by QuarterName desc

LocationMeasureViewR=select distinct NationalProgramQualityMeasureUid, \
case DisplayName when 'APA' then  ' APA'+MeasureId when 'APA' then ' APA'+MeasureId end as MeasureId, \
replace (replace(replace(replace(measure,char(10),' '),char(13),' '),'  ',' '),'in Melanoma ','in Melanoma')  as measureName, \
'(Registry Benchmark: '+CAST(CONVERT(DECIMAL(10,2),NationalAverage*100 ) AS varchar)+'%)' as registryBenchmark, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+'%' as performance, \
ListOrder \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') and QuarterName='2014Q2' and Flag = '@flag' \
and ProviderUid is null and LocationUid ='@SelectedLocation' order by ListOrder

LocationPaginationR=DECLARE  @RowspPage AS INT \
SET @RowspPage = 15 \
SELECT * \
FROM ( \
select ' '+a.name as locationName ,sum(exceeding) exceeding,sum(below) below ,ROW_NUMBER() OVER(order by name) AS Rownumber \
from ( \
select name, \
case when Difference > 0 then 1 else 0 end 'exceeding', \
case when Difference <= 0 then 1 else 0 end 'below' \
from [FIGMDHQIManagement].[dbo].Institution vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.InstitutionUid=msc.LocationUid and msc.QuarterName='2014Q2' and flag='QR' \
and msc.provideruid is  null \
and locationuid is not null \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0 ) a   group by name \
) AS TBL \
WHERE Rownumber BETWEEN ((@pagenumber - 1) * @RowspPage + 1) AND (@pagenumber * @RowspPage)


LocationViewR=select top 15 LocationUid,' '+a.name as locationName,sum(exceeding) exceeding,sum(below) below ,ROW_NUMBER() OVER(order by name,LocationUid desc) AS Rownumber \
from ( \
select LocationUid,name, \
case when Difference > 0 then 1 else 0 end 'exceeding', \
case when Difference <= 0 then 1 else 0 end 'below' \
from [FIGMDHQIManagement].[dbo].Institution vf \
left join [FIGMDWeb].[dbo].ViewMeasureComputationSummary  msc \
on vf.InstitutionUid=msc.LocationUid and msc.QuarterName='2014Q2' and flag='@flag' \
and msc.provideruid is  null \
and locationuid is not null \
where  vf.PracticeUid IN (select PracticeUid from Figuser f inner join individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') \
and vf.inactive=0 ) a   group by LocationUid,name




###mips
MipsProvidersGrid = Select i.first+' '+ i.last as "PROVIDERNAME",replace(Pf.IsProviderEligible,'1','Eligible') as "MIPSELIGIBILITY",PF.NPI as "NPI",PPF.TIN as "TIN",CAST(MPM1.MIPScontribution as float) 'QUALITY', ISNULL(CAST(MPM2.MIPScontribution as VARCHAR(7)),'N/A') as 'ACI', \
CAST(MPM3.MIPScontribution as float)as 'IA',CAST((SUM(MPM1.MIPScontribution)  + SUM(MPM3.MIPScontribution)) as float)as  "MIPSFINALSCORE", \
MPSS.SubmissionStatus as "SUBMISSIONSTATUS" from PQRSProfile PF,Serviceprovider sp,PQRSProfileTinSplitDetail PPF,MipsProfileModuleScore MPM1,MipsProfileModuleScore MPM2,MipsProfileModuleScore MPM3,MasterProfileSubmissionStatus MPSS ,individual i where PF.ProviderUid=Sp.Serviceprovideruid \
and MPM1.PQRSprofileuid=PF.PQRSprofileuid and MPM1.ModuleUid='3AF2E006-783B-4E77-8439-A279E359F652' and MPM2.PQRSprofileuid=PF.PQRSprofileuid and MPM2.ModuleUid='24307E4B-7CF8-4975-B924-4DF23D7064B7' and MPM3.PQRSprofileuid=PF.PQRSprofileuid and MPM3.ModuleUid='0311DEFD-230E-4101-899C-8FC4A9877521' and ppf.PQRSprofileuid=Pf.PQRSprofileuid  and PPF.Inactive='0' and PF.ProfileSubmissionStatusUid=MPSS.ProfileSubmissionStatusUid  and PF.PQRSProfileUid='14A14591-BC2B-4784-8CBD-774E20148E0F' and sp.ServiceProviderUid=i.individualuid Group By i.first,i.last, Pf.IsProviderEligible, PF.NPI, PPF.TIN, MPM1.MIPScontribution, MPM3.MIPScontribution,MPM2.MIPScontribution, MPSS.SubmissionStatus 

Getproviderlistmips=Select Sp.Listname as "PROVIDER",Pf.IsProviderEligible as "MIPSELIGIBILITY",PF.NPI as "NPI",PPF.TIN as "TIN",MPM1.MIPScontribution as 'QUALITY', \
MPM2.MIPScontribution as 'ACI',MPM3.MIPScontribution as 'IA',(MPM1.MIPScontribution+MPM2.MIPScontribution+MPM3.MIPScontribution) as "MIPSFINALSCORE", \
MPSS.SubmissionStatus as "SUBMISSIONSTATUS" \
from PQRSProfile PF,Serviceprovider sp,PQRSProfileTinSplitDetail PPF,MipsProfileModuleScore MPM1,MipsProfileModuleScore MPM2,MipsProfileModuleScore MPM3,MasterProfileSubmissionStatus MPSS \     
where PF.ProviderUid=Sp.Serviceprovideruid \
and MPM1.PQRSprofileuid=PF.PQRSprofileuid and MPM1.ModuleUid='3AF2E006-783B-4E77-8439-A279E359F652' \
and MPM2.PQRSprofileuid=PF.PQRSprofileuid and MPM2.ModuleUid='24307E4B-7CF8-4975-B924-4DF23D7064B7' \
and MPM3.PQRSprofileuid=PF.PQRSprofileuid and MPM3.ModuleUid='0311DEFD-230E-4101-899C-8FC4A9877521' \
and ppf.PQRSprofileuid=Pf.PQRSprofileuid  and PPF.Inactive='0' \
and PF.ProfileSubmissionStatusUid=MPSS.ProfileSubmissionStatusUid \
and PF.PQRSProfileUid='14A14591-BC2B-4784-8CBD-774E20148E0F' \

SearchedProviderCount= select count(*)as "SearchCount" from PQRSProfile PF,Serviceprovider sp,PQRSProfileTinSplitDetail PPF,MipsProfileModuleScore MPM1,MipsProfileModuleScore MPM2,MipsProfileModuleScore MPM3,MasterProfileSubmissionStatus MPSS ,individual i where PF.ProviderUid=Sp.Serviceprovideruid \
and MPM1.PQRSprofileuid=PF.PQRSprofileuid and MPM1.ModuleUid='3AF2E006-783B-4E77-8439-A279E359F652' and MPM2.PQRSprofileuid=PF.PQRSprofileuid and MPM2.ModuleUid='24307E4B-7CF8-4975-B924-4DF23D7064B7' and MPM3.PQRSprofileuid=PF.PQRSprofileuid and MPM3.ModuleUid='0311DEFD-230E-4101-899C-8FC4A9877521' and ppf.PQRSprofileuid=Pf.PQRSprofileuid  and PPF.Inactive='0' and PF.ProfileSubmissionStatusUid=MPSS.ProfileSubmissionStatusUid  and PF.PQRSProfileUid='14A14591-BC2B-4784-8CBD-774E20148E0F' and sp.ServiceProviderUid=i.individualuid Group By i.first,i.last, Pf.IsProviderEligible, PF.NPI, PPF.TIN, MPM1.MIPScontribution, MPM3. \
MIPScontribution,MPM2.MIPScontribution, MPSS.SubmissionStatus 


##############    DASHBOARD Practice Performance Trend   ###############

PPTTableView= select QuarterName Quarter,(Numerator+NotMet) as "All",Numerator as Met, \
NotMet,cast((cast(Average as float)*100.00) as decimal(5,2)) as "Percentage" \
from FIGMDWeb.dbo.viewMeasurecomputationSummary \
where MeasureId='@measureID' and  QuarterEndDate>='2015-06-30' and QuarterEndDate<='2016-03-31' and \
PracticeUid='3A24533F-2471-4B34-9370-6B5749304216' and ProviderUid is NULL \
and LocationUid is NULL \
and Flag='QR' \
order by QuarterEndDate desc

 


###Dashboard->Practice###
PracticeMeasureGrid = select distinct (DisplayName + '' +MeasureId) as ID, Replace(ShortDescription,' ','') as Measure, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+'%' as Performance,\
'RegistryAverage:'+CAST(CONVERT(DECIMAL(10,2),NationalAverage*100 ) AS varchar)+'%' as RegistryAverage, ListOrder \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where PracticeUid IN (select PracticeUid from [FIGMDHQIManagement].dbo.FIGUser f inner join [FIGMDHQIManagement].dbo.Individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') and QuarterName='@quartermonth' and Flag = '@flag' and ProviderUid is null and LocationUid is null and MeasureType='0'\
order by ListOrder

PracticeAllMeasureCountR = select distinct COUNT(MeasureId) as Count from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary] \
where PracticeUid IN (select PracticeUid from [FIGMDHQIManagement].dbo.FIGUser f inner join [FIGMDHQIManagement].dbo.Individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') and QuarterName='@quartermonth' and Flag = '@flag' \
and ProviderUid is null and LocationUid is null and MeasureType='0'

PFMViewR = select (DisplayName + '' +MeasureId) as ID, \
Replace(ShortDescription,' ','') as Measure,\
'RegistryAverage:'+CAST(CONVERT(DECIMAL(10,2),NationalAverage*100 ) AS varchar)+'%' as RegistryAverage, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+'%' as Performance, ListOrder \
from [FIGMDWeb].dbo.ViewMeasureComputationSummary v \
inner join [FIGMDWeb].dbo.FIGUserFavorite f on f.Value = v.NationalProgramQualityMeasureUid \
where PracticeUid IN \
(select PracticeUid from [FIGMDHQIManagement].dbo.FIGUser f inner join [FIGMDHQIManagement].dbo.Individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') and QuarterName='@quartermonth'  and Flag = '@flag' \
and ProviderUid is null and LocationUid is null AND f.FIGUserUid in(select FIGUserUid from [FIGMDHQIManagement].dbo.FIGUser where loginname ='@loginuser') \
AND f.PageName = 'MEASURE' \
order by ListOrder

PFMCountR = select distinct Count(Measure) as totalcount \
from [FIGMDWeb].dbo.ViewMeasureComputationSummary v \
inner join [FIGMDWeb].dbo.FIGUserFavorite f on f.Value = v.NationalProgramQualityMeasureUid \
where PracticeUid IN \
(select PracticeUid from [FIGMDHQIManagement].dbo.FIGUser f inner join [FIGMDHQIManagement].dbo.Individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') and QuarterName='@quartermonth' and Flag = '@flag' \
and ProviderUid is null and LocationUid is null AND f.FIGUserUid in(select FIGUserUid from [FIGMDHQIManagement].dbo.FIGUser where loginname ='@loginuser') \
AND f.PageName = 'MEASURE'

PracticeMeasureHighLowScore = select (DisplayName + '' +MeasureId) as ID, \
Replace(ShortDescription,' ','') as Measure, \
'RegistryAverage:'+CAST(CONVERT(DECIMAL(10,2),NationalAverage*100 ) AS varchar)+'%' as RegistryAverage, \
CAST(CONVERT(DECIMAL(10,2),Average*100) AS varchar)+'%' as Performance, ListOrder \
from [FIGMDWeb].[dbo].[ViewMeasureComputationSummary]  \
where PracticeUid IN (select PracticeUid from [FIGMDHQIManagement].dbo.FIGUser f inner join [FIGMDHQIManagement].dbo.Individual i \
on f.Figuseruid = i.individualuid \
where loginname ='@loginuser') and QuarterName='@quartermonth' and Flag = '@flag' \
and ProviderUid is null and LocationUid is null and MeasureType='0' and IsDownwardTrending='@score' \
order by ListOrder \

LastUpdatedDate = Select top 1 CONVERT(VARCHAR, P.EndTime, 101) + ' ' + \
        CONVERT(VARCHAR, DATEPART(hh, P.EndTime)) + ':' + \
        RIGHT('0' + CONVERT(VARCHAR, DATEPART(mi, P.EndTime)), 2) AS Date,P.QuarterEndDate from [FIGMDWeb].[dbo].[PracticeRefreshStatus] P \
where PracticeUid IN(select PracticeUid from [FIGMDHQIManagement].dbo.FIGUser f inner join [FIGMDHQIManagement].dbo.Individual i on \
f.Figuseruid = i.individualuid where loginname ='@loginuser') and P.Flag='@flag' and \
P.QuarterEndDate = (select distinct QuarterEndDate from [FIGMDWeb].[dbo].ViewMeasureComputationSummary where QuarterName='@quartermonth')\
order by  P.Endtime desc
